AT_SETUP([test a merge 5])
MONOTONE_SETUP

# This test is a bug report.
AT_XFAIL_IF(true)

NEED_UNB64

# Another real merge error. This is the diff between the correct
# result and the file produced by the merge:
#
# --- correct
# +++ testfile
# @@ -99,6 +99,8 @@
#  
#    void get_ids(std::string const & table, std::set< hexenc<id> > & ids); 
#  
# +  void get_ids(std::string const & table, std::set< hexenc<id> > & ids); 
# +
#    void get(hexenc<id> const & new_id,
#             base64< gzip<data> > & dat,
#             std::string const & table);

# This seems to be a really nasty testcase somehow.  monotone and
# merge(1) give identical, incorrect output.  diff3(1) reports a
# conflict.  xxdiff merges cleanly, and, AFAICT, correctly.

AT_DATA(parent.b64, [
I2lmbmRlZiBfX0RBVEFCQVNFX0hIX18KI2RlZmluZSBfX0RBVEFCQVNFX0hIX18KCi8vIGNvcHly
aWdodCAoQykgMjAwMiwgMjAwMyBncmF5ZG9uIGhvYXJlIDxncmF5ZG9uQHBvYm94LmNvbT4KLy8g
YWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gbGljZW5zZWQgdG8gdGhlIHB1YmxpYyB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBHUEwgKD49IDIpCi8vIHNlZSB0aGUgZmlsZSBDT1BZSU5HIGZvciBk
ZXRhaWxzCgpzdHJ1Y3Qgc3FsaXRlMzsKc3RydWN0IGNlcnQ7CgojaW5jbHVkZSA8dmVjdG9yPgoj
aW5jbHVkZSA8c2V0PgojaW5jbHVkZSA8c3RyaW5nPgoKI2luY2x1ZGUgPGJvb3N0L2ZpbGVzeXN0
ZW0vcGF0aC5ocHA+CgojaW5jbHVkZSAiY29tbWFuZHMuaGgiCiNpbmNsdWRlICJtYW5pZmVzdC5o
aCIKI2luY2x1ZGUgIm51bWVyaWNfdm9jYWIuaGgiCiNpbmNsdWRlICJ2b2NhYi5oaCIKCnN0cnVj
dCByZXZpc2lvbl9zZXQ7CgovLyB0aGlzIGZpbGUgZGVmaW5lcyBhIHB1YmxpYywgdHlwZWQgaW50
ZXJmYWNlIHRvIHRoZSBkYXRhYmFzZS4KLy8gdGhlIGRhdGFiYXNlIGNsYXNzIGVuY2Fwc3VsYXRl
cyBhbGwga25vd2xlZGdlIGFib3V0IHNxbGl0ZSwKLy8gdGhlIHNjaGVtYSwgYW5kIGFsbCBTUUwg
c3RhdGVtZW50cyB1c2VkIHRvIGFjY2VzcyB0aGUgc2NoZW1hLgovLwovLyBvbmUgdGhpbmcgd2hp
Y2ggaXMgcmF0aGVyIGltcG9ydGFudCB0byBub3RlIGlzIHRoYXQgdGhpcyBmaWxlCi8vIGRlYWxz
IHdpdGggdHdvIHNvcnRzIG9mIHZlcnNpb24gcmVsYXRpb25zaGlwcy4gdGhlIHZlcnNpb25zCi8v
IHN0b3JlZCBpbiB0aGUgZGF0YWJhc2UgYXJlIGFsbCAqYmFja3dhcmRzKiBmcm9tIHRob3NlIHRo
ZSBwcm9ncmFtCi8vIHNlZXMuIHNvIGZvciBleGFtcGxlIGlmIHlvdSBoYXZlIHR3byB2ZXJzaW9u
cyBvZiBhIGZpbGUKLy8gCi8vIGZpbGUuMSwgZmlsZS4yCi8vCi8vIHdoZXJlIGZpbGUuMiB3YXMg
YSBtb2RpZmljYXRpb24gb2YgZmlsZS4xLCB0aGVuIGFzIGZhciBhcyB0aGUgcmVzdCBvZgovLyB0
aGUgYXBwbGljYXRpb24gaXMgY29uY2VybmVkIC0tIGFuZCB0aGUgYW5jZXN0cnkgZ3JhcGggLS0g
ZmlsZS4xIGlzIHRoZQovLyAib2xkIiB2ZXJzaW9uIGFuZCBmaWxlLjIgaXMgdGhlICJuZXciIHZl
cnNpb24uIG5vdGUgdGhlIHVzZSBvZiB0ZXJtcwovLyB3aGljaCBkZXNjcmliZSB0aW1lLCBhbmQg
dGhlIHNlcXVlbmNlIG9mIGVkaXRzIGEgdXNlciBtYWtlcyB0byBhCi8vIGZpbGUuIHRob3NlIGFy
ZSBhbmNlc3RyeSB0ZXJtcy4gd2hlbiB0aGUgYXBwbGljYXRpb24gY29tcG9zZXMgYQovLyBwYXRj
aHNldCwgZm9yIGV4YW1wbGUsIGl0J2xsIGNvbnRhaW4gdGhlIGRpZmYgZGVsdGEoZmlsZS4xLCBm
aWxlLjIpCi8vCi8vIGZyb20gdGhlIGRhdGFiYXNlJ3MgcGVyc3BlY3RpdmUsIGhvd2V2ZXIsIGZp
bGUuMSBpcyB0aGUgZGVyaXZlZCB2ZXJzaW9uLAovLyBhbmQgZmlsZS4yIGlzIHRoZSBiYXNlIHZl
cnNpb24uIHRoZSBiYXNlIHZlcnNpb24gaXMgc3RvcmVkIGluIHRoZQovLyAiZmlsZXMiIHRhYmxl
LCBhbmQgdGhlICpyZXZlcnNlKiBkaWZmIGRlbHRhKGZpbGUuMiwgZmlsZS4xKSBpcyBzdG9yZWQg
aW4KLy8gdGhlICJmaWxlX2RlbHRhcyIgdGFibGUsIHVuZGVyIHRoZSBpZCBvZiBmaWxlLjEsIHdp
dGggdGhlIGlkIG9mIGZpbGUuMgovLyBsaXN0ZWQgYXMgaXRzIGJhc2UuIG5vdGUgdGhlIHVzZSBv
ZiB0aGUgdGVybXMgd2hpY2ggZGVzY3JpYmUKLy8gcmVjb25zdHJ1Y3Rpb247IHRob3NlIGFyZSBz
dG9yYWdlLXN5c3RlbSB0ZXJtcy4KLy8KLy8gdGhlIGludGVyZmFjZSAqdG8qIHRoZSBkYXRhYmFz
ZSwgYW5kIHRoZSBhbmNlc3RyeSB2ZXJzaW9uIGdyYXBocywgdXNlCi8vIHRoZSBvbGQgLyBuZXcg
bWV0YXBob3Igb2YgYW5jZXN0cnksIGJ1dCB3aXRoaW4gdGhlIGRhdGFiYXNlIChpbmNsdWRpbmcK
Ly8gdGhlIHByaXZhdGUgaGVscGVyIG1ldGhvZHMsIGFuZCB0aGUgc3RvcmFnZSB2ZXJzaW9uIGdy
YXBocykgdGhlCi8vIGJhc2UvZGVyaXZlZCBzdG9yYWdlIG1ldGFwaG9yIGlzIHVzZWQuIHRoZSBv
bmx5IHJlYWwgd2F5IHRvIHRlbGwgd2hpY2gKLy8gaXMgd2hpY2ggaXMgdG8gbG9vayBhdCB0aGUg
cGFyYW1ldGVyIG5hbWVzIGFuZCBjb2RlLiBJIG1pZ2h0IHRyeSB0bwovLyBleHByZXNzIHRoaXMg
aW4gdGhlIHR5cGUgc3lzdGVtIHNvbWUgZGF5LCBidXQgbm90IHByZXNlbnRseS4KLy8KLy8gdGhl
IGtleSBwaHJhc2UgdG8ga2VlcCByZXBlYXRpbmcgd2hlbiB3b3JraW5nIG9uIHRoaXMgY29kZSBp
czoKLy8gCi8vICJiYXNlIGZpbGVzIGFyZSBuZXcsIGRlcml2ZWQgZmlsZXMgYXJlIG9sZCIKLy8K
Ly8gaXQgbWFrZXMgdGhlIGNvZGUgY29uZnVzaW5nLCBJIGtub3cuIHRoaXMgaXMgcG9zc2libHkg
dGhlIHdvcnN0IHBhcnQgb2YKLy8gdGhlIHByb2dyYW0uIEkgZG9uJ3Qga25vdyBpZiB0aGVyZSdz
IGFueSB3YXkgdG8gbWFrZSBpdCBjbGVhcmVyLgoKY2xhc3MgdHJhbnNhY3Rpb25fZ3VhcmQ7CnN0
cnVjdCBwb3N0aW5nOwpzdHJ1Y3QgYXBwX3N0YXRlOwoKY2xhc3MgZGF0YWJhc2UKewogIGZzOjpw
YXRoIGZpbGVuYW1lOwogIHN0ZDo6c3RyaW5nIGNvbnN0IHNjaGVtYTsKICB2b2lkIGNoZWNrX3Nj
aGVtYSgpOwoKICBzdHJ1Y3QgYXBwX3N0YXRlICogX19hcHA7CiAgc3RydWN0IHNxbGl0ZTMgKiBf
X3NxbDsKICBzdHJ1Y3Qgc3FsaXRlMyAqIHNxbChib29sIGluaXQgPSBmYWxzZSk7CiAgaW50IHRy
YW5zYWN0aW9uX2xldmVsOwoKICB2b2lkIGluc3RhbGxfZnVuY3Rpb25zKGFwcF9zdGF0ZSAqIGFw
cCk7CiAgdm9pZCBpbnN0YWxsX3ZpZXdzKCk7CgogIHR5cGVkZWYgc3RkOjp2ZWN0b3I8IHN0ZDo6
dmVjdG9yPHN0ZDo6c3RyaW5nPiA+IHJlc3VsdHM7CiAgdm9pZCBleGVjdXRlKGNoYXIgY29uc3Qg
KiBxdWVyeSwgLi4uKTsKICB2b2lkIGZldGNoKHJlc3VsdHMgJiByZXMsIAogICAgICAgICAgICAg
aW50IGNvbnN0IHdhbnRfY29scywgCiAgICAgICAgICAgICBpbnQgY29uc3Qgd2FudF9yb3dzLCAK
ICAgICAgICAgICAgIGNoYXIgY29uc3QgKiBxdWVyeSwgLi4uKTsKCiAgYm9vbCBleGlzdHMoaGV4
ZW5jPGlkPiBjb25zdCAmIGlkZW50LCAKICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAm
IHRhYmxlKTsKICBib29sIGRlbHRhX2V4aXN0cyhoZXhlbmM8aWQ+IGNvbnN0ICYgaWRlbnQsCiAg
ICAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7CiAgYm9vbCBkZWx0
YV9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkZW50LAogICAgICAgICAgICAgICAgICAgIGhl
eGVuYzxpZD4gY29uc3QgJiBiYXNlLAogICAgICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNv
bnN0ICYgdGFibGUpOwoKICBpbnQgY291bnQoc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7Cgog
IHZvaWQgZ2V0KGhleGVuYzxpZD4gY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAgYmFzZTY0PCBn
emlwPGRhdGE+ID4gJiBkYXQsCiAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7
CiAgdm9pZCBnZXRfZGVsdGEoaGV4ZW5jPGlkPiBjb25zdCAmIGlkZW50LAogICAgICAgICAgICAg
ICAgIGhleGVuYzxpZD4gY29uc3QgJiBiYXNlLAogICAgICAgICAgICAgICAgIGJhc2U2NDwgZ3pp
cDxkZWx0YT4gPiAmIGRlbCwKICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRh
YmxlKTsKICB2b2lkIGdldF92ZXJzaW9uKGhleGVuYzxpZD4gY29uc3QgJiBpZCwKICAgICAgICAg
ICAgICAgICAgIGJhc2U2NDwgZ3ppcDxkYXRhPiA+ICYgZGF0LAogICAgICAgICAgICAgICAgICAg
c3RkOjpzdHJpbmcgY29uc3QgJiBkYXRhX3RhYmxlLAogICAgICAgICAgICAgICAgICAgc3RkOjpz
dHJpbmcgY29uc3QgJiBkZWx0YV90YWJsZSk7CiAgCiAgdm9pZCBwdXQoaGV4ZW5jPGlkPiBjb25z
dCAmIG5ld19pZCwKICAgICAgICAgICBiYXNlNjQ8IGd6aXA8ZGF0YT4gPiBjb25zdCAmIGRhdCwK
ICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxlKTsKICB2b2lkIGRyb3AoaGV4ZW5j
PGlkPiBjb25zdCAmIGJhc2UsCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUp
OwogIHZvaWQgcHV0X2RlbHRhKGhleGVuYzxpZD4gY29uc3QgJiBpZCwKICAgICAgICAgICAgICAg
ICBoZXhlbmM8aWQ+IGNvbnN0ICYgYmFzZSwKICAgICAgICAgICAgICAgICBiYXNlNjQ8IGd6aXA8
ZGVsdGE+ID4gY29uc3QgJiBkZWwsCiAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3Qg
JiB0YWJsZSk7CiAgdm9pZCBwdXRfdmVyc2lvbihoZXhlbmM8aWQ+IGNvbnN0ICYgb2xkX2lkLAog
ICAgICAgICAgICAgICAgICAgaGV4ZW5jPGlkPiBjb25zdCAmIG5ld19pZCwKICAgICAgICAgICAg
ICAgICAgIGJhc2U2NDwgZ3ppcDxkZWx0YT4gPiBjb25zdCAmIGRlbCwKICAgICAgICAgICAgICAg
ICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgZGF0YV90YWJsZSwKICAgICAgICAgICAgICAgICAgIHN0
ZDo6c3RyaW5nIGNvbnN0ICYgZGVsdGFfdGFibGUpOwogIHZvaWQgcHV0X3JldmVyc2VfdmVyc2lv
bihoZXhlbmM8aWQ+IGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICBo
ZXhlbmM8aWQ+IGNvbnN0ICYgb2xkX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNl
NjQ8IGd6aXA8ZGVsdGE+ID4gY29uc3QgJiByZXZlcnNlX2RlbCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiBkYXRhX3RhYmxlLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIGRlbHRhX3RhYmxlKTsKCiAgYm9vbCBjZXJ0
X2V4aXN0cyhjZXJ0IGNvbnN0ICYgdCwKICAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29u
c3QgJiB0YWJsZSk7CiAgdm9pZCBwdXRfY2VydChjZXJ0IGNvbnN0ICYgdCwgc3RkOjpzdHJpbmcg
Y29uc3QgJiB0YWJsZSk7ICAKICB2b2lkIHJlc3VsdHNfdG9fY2VydHMocmVzdWx0cyBjb25zdCAm
IHJlcywKICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnZlY3RvcjxjZXJ0PiAmIGNlcnRzKTsK
CiAgdm9pZCBnZXRfY2VydHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkLCAKICAgICAgICAgICAgICAg
IHN0ZDo6dmVjdG9yPCBjZXJ0ID4gJiBjZXJ0cywKICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5n
IGNvbnN0ICYgdGFibGUpOyAgCgogIHZvaWQgZ2V0X2NlcnRzKGNlcnRfbmFtZSBjb25zdCAmIG5h
bWUsICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHN0ZDo6dmVjdG9yPCBjZXJ0ID4gJiBj
ZXJ0cywKICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOwoKICB2b2lk
IGdldF9jZXJ0cyhoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICBjZXJ0X25h
bWUgY29uc3QgJiBuYW1lLAogICAgICAgICAgICAgICAgc3RkOjp2ZWN0b3I8IGNlcnQgPiAmIGNl
cnRzLAogICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7ICAKCiAgdm9p
ZCBnZXRfY2VydHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkLAogICAgICAgICAgICAgICAgY2VydF9u
YW1lIGNvbnN0ICYgbmFtZSwKICAgICAgICAgICAgICAgIGJhc2U2NDxjZXJ0X3ZhbHVlPiBjb25z
dCAmIHZhbCwgCiAgICAgICAgICAgICAgICBzdGQ6OnZlY3RvcjwgY2VydCA+ICYgY2VydHMsCiAg
ICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxlKTsgIAoKICB2b2lkIGdldF9j
ZXJ0cyhjZXJ0X25hbWUgY29uc3QgJiBuYW1lLAogICAgICAgICAgICAgICAgYmFzZTY0PGNlcnRf
dmFsdWU+IGNvbnN0ICYgdmFsLCAKICAgICAgICAgICAgICAgIHN0ZDo6dmVjdG9yPGNlcnQ+ICYg
Y2VydHMsCiAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxlKTsKCiAgdm9p
ZCBiZWdpbl90cmFuc2FjdGlvbigpOwogIHZvaWQgY29tbWl0X3RyYW5zYWN0aW9uKCk7CiAgdm9p
ZCByb2xsYmFja190cmFuc2FjdGlvbigpOwogIGZyaWVuZCBjbGFzcyB0cmFuc2FjdGlvbl9ndWFy
ZDsKICBmcmllbmQgdm9pZCByY3NfcHV0X3Jhd19maWxlX2VkZ2UoaGV4ZW5jPGlkPiBjb25zdCAm
IG9sZF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV4ZW5jPGlkPiBj
b25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTY0
PCBnemlwPGRlbHRhPiA+IGNvbnN0ICYgZGVsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBkYXRhYmFzZSAmIGRiKTsKICBmcmllbmQgdm9pZCByY3NfcHV0X3Jhd19tYW5pZmVz
dF9lZGdlKGhleGVuYzxpZD4gY29uc3QgJiBvbGRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBoZXhlbmM8aWQ+IGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTY0PCBnemlwPGRlbHRhPiA+IGNvbnN0ICYg
ZGVsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2UgJiBk
Yik7CgpwdWJsaWM6CgogIGRhdGFiYXNlKGZzOjpwYXRoIGNvbnN0ICYgZmlsZSk7CgogIHVuc2ln
bmVkIGxvbmcgZ2V0X3N0YXRpc3RpYyhzdGQ6OnN0cmluZyBjb25zdCAmIHF1ZXJ5KTsKICB2b2lk
IHNldF9maWxlbmFtZShmczo6cGF0aCBjb25zdCAmIGZpbGUpOwogIHZvaWQgaW5pdGlhbGl6ZSgp
OwogIHZvaWQgZGVidWcoc3RkOjpzdHJpbmcgY29uc3QgJiBzcWwsIHN0ZDo6b3N0cmVhbSAmIG91
dCk7CiAgdm9pZCBkdW1wKHN0ZDo6b3N0cmVhbSAmKTsKICB2b2lkIGxvYWQoc3RkOjppc3RyZWFt
ICYpOwogIHZvaWQgaW5mbyhzdGQ6Om9zdHJlYW0gJik7CiAgdm9pZCB2ZXJzaW9uKHN0ZDo6b3N0
cmVhbSAmKTsKICB2b2lkIG1pZ3JhdGUoKTsKICB2b2lkIHJlaGFzaCgpOwogIHZvaWQgZW5zdXJl
X29wZW4oKTsKICAKICBib29sIGZpbGVfdmVyc2lvbl9leGlzdHMoZmlsZV9pZCBjb25zdCAmIGlk
KTsKICBib29sIG1hbmlmZXN0X3ZlcnNpb25fZXhpc3RzKG1hbmlmZXN0X2lkIGNvbnN0ICYgaWQp
OwogIGJvb2wgcmV2aXNpb25fZXhpc3RzKHJldmlzaW9uX2lkIGNvbnN0ICYgaWQpOwogIHZvaWQg
c2V0X2FwcChhcHBfc3RhdGUgKiBhcHApOwogIAogIC8vIGdldCBwbGFpbiB2ZXJzaW9uIGlmIGl0
IGV4aXN0cywgb3IgcmVjb25zdHJ1Y3QgdmVyc2lvbgogIC8vIGZyb20gZGVsdGFzIChpZiB0aGV5
IGV4aXN0KQogIHZvaWQgZ2V0X2ZpbGVfdmVyc2lvbihmaWxlX2lkIGNvbnN0ICYgaWQsCiAgICAg
ICAgICAgICAgICAgICAgICAgIGZpbGVfZGF0YSAmIGRhdCk7CgogIC8vIGdldCBmaWxlIGRlbHRh
IGlmIGl0IGV4aXN0cywgZWxzZSBjYWxjdWxhdGUgaXQuCiAgLy8gYm90aCBtYW5pZmVzdHMgbXVz
dCBleGlzdC4KICB2b2lkIGdldF9maWxlX2RlbHRhKGZpbGVfaWQgY29uc3QgJiBzcmMsCiAgICAg
ICAgICAgICAgICAgICAgICBmaWxlX2lkIGNvbnN0ICYgZHN0LAogICAgICAgICAgICAgICAgICAg
ICAgZmlsZV9kZWx0YSAmIGRlbCk7CgogIC8vIHB1dCBmaWxlIHcvbyBwcmVkZWNlc3NvciBpbnRv
IGRiCiAgdm9pZCBwdXRfZmlsZShmaWxlX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgICAg
ICAgZmlsZV9kYXRhIGNvbnN0ICYgZGF0KTsKCiAgLy8gc3RvcmUgbmV3IHZlcnNpb24gYW5kIHVw
ZGF0ZSBvbGQgdmVyc2lvbiB0byBiZSBhIGRlbHRhCiAgdm9pZCBwdXRfZmlsZV92ZXJzaW9uKGZp
bGVfaWQgY29uc3QgJiBvbGRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfaWQgY29u
c3QgJiBuZXdfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfZGVsdGEgY29uc3QgJiBk
ZWwpOwoKICAvLyBsb2FkIGluIGEgImRpcmVjdCIgbmV3IC0+IG9sZCByZXZlcnNlIGVkZ2UgKHVz
ZWQgZHVyaW5nCiAgLy8gbmV0c3luYyBhbmQgQ1ZTIGxvYWQtaW4pCiAgdm9pZCBwdXRfZmlsZV9y
ZXZlcnNlX3ZlcnNpb24oZmlsZV9pZCBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBmaWxlX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGZpbGVfZGVsdGEgY29uc3QgJiBkZWwpOwoKICAvLyBnZXQgcGxhaW4gdmVy
c2lvbiBpZiBpdCBleGlzdHMsIG9yIHJlY29uc3RydWN0IHZlcnNpb24KICAvLyBmcm9tIGRlbHRh
cyAoaWYgdGhleSBleGlzdCkuIAogIHZvaWQgZ2V0X21hbmlmZXN0X3ZlcnNpb24obWFuaWZlc3Rf
aWQgY29uc3QgJiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2RhdGEg
JiBkYXQpOwoKICAvLyBnZXQgYSBjb25zdHJ1Y3RlZCBtYW5pZmVzdAogIHZvaWQgZ2V0X21hbmlm
ZXN0KG1hbmlmZXN0X2lkIGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3Rf
bWFwICYgbW0pOwoKICAvLyBnZXQgbWFuaWZlc3QgZGVsdGEgaWYgaXQgZXhpc3RzLCBlbHNlIGNh
bGN1bGF0ZSBpdC4KICAvLyBib3RoIG1hbmlmZXN0cyBtdXN0IGV4aXN0LgogIHZvaWQgZ2V0X21h
bmlmZXN0X2RlbHRhKG1hbmlmZXN0X2lkIGNvbnN0ICYgc3JjLAogICAgICAgICAgICAgICAgICAg
ICAgICAgIG1hbmlmZXN0X2lkIGNvbnN0ICYgZHN0LAogICAgICAgICAgICAgICAgICAgICAgICAg
IG1hbmlmZXN0X2RlbHRhICYgZGVsKTsKCiAgLy8gcHV0IG1hbmlmZXN0IHcvbyBwcmVkZWNlc3Nv
ciBpbnRvIGRiCiAgdm9pZCBwdXRfbWFuaWZlc3QobWFuaWZlc3RfaWQgY29uc3QgJiBuZXdfaWQs
CiAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3RfZGF0YSBjb25zdCAmIGRhdCk7CgogIC8vIHN0
b3JlIG5ldyB2ZXJzaW9uIGFuZCB1cGRhdGUgb2xkIHZlcnNpb24gdG8gYmUgYSBkZWx0YQogIHZv
aWQgcHV0X21hbmlmZXN0X3ZlcnNpb24obWFuaWZlc3RfaWQgY29uc3QgJiBvbGRfaWQsCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdF9pZCBjb25zdCAmIG5ld19pZCwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2RlbHRhIGNvbnN0ICYgZGVsKTsKCiAgLy8g
bG9hZCBpbiBhICJkaXJlY3QiIG5ldyAtPiBvbGQgcmV2ZXJzZSBlZGdlICh1c2VkIGR1cmluZwog
IC8vIG5ldHN5bmMgYW5kIENWUyBsb2FkLWluKQogIHZvaWQgcHV0X21hbmlmZXN0X3JldmVyc2Vf
dmVyc2lvbihtYW5pZmVzdF9pZCBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbWFuaWZlc3RfaWQgY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2RlbHRhIGNvbnN0ICYgZGVsKTsKCgogIHZv
aWQgZ2V0X3JldmlzaW9uX2FuY2VzdHJ5KHN0ZDo6bXVsdGltYXA8cmV2aXNpb25faWQsIHJldmlz
aW9uX2lkPiAmIGdyYXBoKTsKCiAgdm9pZCBnZXRfcmV2aXNpb25fcGFyZW50cyhyZXZpc2lvbl9p
ZCBjb25zdCAmIGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnNldDxyZXZpc2lv
bl9pZD4gJiBwYXJlbnRzKTsKCiAgdm9pZCBnZXRfcmV2aXNpb25fY2hpbGRyZW4ocmV2aXNpb25f
aWQgY29uc3QgJiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnNldDxyZXZp
c2lvbl9pZD4gJiBjaGlsZHJlbik7CgogIHZvaWQgZ2V0X3JldmlzaW9uX21hbmlmZXN0KHJldmlz
aW9uX2lkIGNvbnN0ICYgY2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3Rf
aWQgJiBtaWQpOwoKICB2b2lkIGdldF9yZXZpc2lvbihyZXZpc2lvbl9pZCBjb25zdCAmIGlkLAog
ICAgICAgICAgICAgICAgICAgcmV2aXNpb25fc2V0ICYgY3MpOwoKICB2b2lkIGdldF9yZXZpc2lv
bihyZXZpc2lvbl9pZCBjb25zdCAmIGlkLAogICAgICAgICAgICAgICAgICAgcmV2aXNpb25fZGF0
YSAmIGRhdCk7CgogIHZvaWQgcHV0X3JldmlzaW9uKHJldmlzaW9uX2lkIGNvbnN0ICYgbmV3X2lk
LAogICAgICAgICAgICAgICAgICAgcmV2aXNpb25fc2V0IGNvbnN0ICYgY3MpOwoKICB2b2lkIHB1
dF9yZXZpc2lvbihyZXZpc2lvbl9pZCBjb25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAgICAg
ICByZXZpc2lvbl9kYXRhIGNvbnN0ICYgZGF0KTsKICAKICB2b2lkIGRlbGV0ZV9leGlzdGluZ19y
ZXZzX2FuZF9jZXJ0cygpOwoKICAvLyBjcnlwdG8ga2V5IC8gY2VydCBvcGVyYXRpb25zCgogIHZv
aWQgZ2V0X2tleV9pZHMoc3RkOjpzdHJpbmcgY29uc3QgJiBwYXR0ZXJuLAogICAgICAgICAgICAg
ICAgICAgc3RkOjp2ZWN0b3I8cnNhX2tleXBhaXJfaWQ+ICYgcHVia2V5cywKICAgICAgICAgICAg
ICAgICAgIHN0ZDo6dmVjdG9yPHJzYV9rZXlwYWlyX2lkPiAmIHByaXZrZXlzKTsKCiAgdm9pZCBn
ZXRfcHJpdmF0ZV9rZXlzKHN0ZDo6dmVjdG9yPHJzYV9rZXlwYWlyX2lkPiAmIHByaXZrZXlzKTsK
CiAgYm9vbCBrZXlfZXhpc3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwoKICBib29sIHB1
YmxpY19rZXlfZXhpc3RzKGhleGVuYzxpZD4gY29uc3QgJiBoYXNoKTsKICBib29sIHB1YmxpY19r
ZXlfZXhpc3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwogIGJvb2wgcHJpdmF0ZV9rZXlf
ZXhpc3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwogIAogIHZvaWQgZ2V0X3B1YmtleSho
ZXhlbmM8aWQ+IGNvbnN0ICYgaGFzaCwgCiAgICAgICAgICAgICAgICAgIHJzYV9rZXlwYWlyX2lk
ICYgaWQsCiAgICAgICAgICAgICAgICAgIGJhc2U2NDxyc2FfcHViX2tleT4gJiBwdWJfZW5jb2Rl
ZCk7CgogIHZvaWQgZ2V0X2tleShyc2Ffa2V5cGFpcl9pZCBjb25zdCAmIGlkLCAKICAgICAgICAg
ICAgICAgYmFzZTY0PHJzYV9wdWJfa2V5PiAmIHB1Yl9lbmNvZGVkKTsKCiAgdm9pZCBnZXRfa2V5
KHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICBiYXNlNjQ8IGFyYzQ8
cnNhX3ByaXZfa2V5PiA+ICYgcHJpdl9lbmNvZGVkKTsKCiAgdm9pZCBwdXRfa2V5KHJzYV9rZXlw
YWlyX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICBiYXNlNjQ8cnNhX3B1Yl9rZXk+IGNv
bnN0ICYgcHViX2VuY29kZWQpOwogIAogIHZvaWQgcHV0X2tleShyc2Ffa2V5cGFpcl9pZCBjb25z
dCAmIGlkLCAKICAgICAgICAgICAgICAgYmFzZTY0PCBhcmM0PHJzYV9wcml2X2tleT4gPiBjb25z
dCAmIHByaXZfZW5jb2RlZCk7CiAgCiAgdm9pZCBwdXRfa2V5X3BhaXIocnNhX2tleXBhaXJfaWQg
Y29uc3QgJiBwdWJfaWQsIAogICAgICAgICAgICAgICAgICAgIGJhc2U2NDxyc2FfcHViX2tleT4g
Y29uc3QgJiBwdWJfZW5jb2RlZCwKICAgICAgICAgICAgICAgICAgICBiYXNlNjQ8IGFyYzQ8cnNh
X3ByaXZfa2V5PiA+IGNvbnN0ICYgcHJpdl9lbmNvZGVkKTsKCiAgdm9pZCBkZWxldGVfcHJpdmF0
ZV9rZXkocnNhX2tleXBhaXJfaWQgY29uc3QgJiBwdWJfaWQpOwoKICAvLyBub3RlOiB0aGlzIHNl
Y3Rpb24gaXMgcmlkaWN1bG91cy4gcGxlYXNlIGRvIHNvbWV0aGluZyBhYm91dCBpdC4KCiAgYm9v
bCBtYW5pZmVzdF9jZXJ0X2V4aXN0cyhtYW5pZmVzdDxjZXJ0PiBjb25zdCAmIGNlcnQpOwogIGJv
b2wgbWFuaWZlc3RfY2VydF9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gpOwogIHZvaWQg
cHV0X21hbmlmZXN0X2NlcnQobWFuaWZlc3Q8Y2VydD4gY29uc3QgJiBjZXJ0KTsKCiAgYm9vbCBy
ZXZpc2lvbl9jZXJ0X2V4aXN0cyhyZXZpc2lvbjxjZXJ0PiBjb25zdCAmIGNlcnQpOwogIGJvb2wg
cmV2aXNpb25fY2VydF9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gpOwoKICB2b2lkIHB1
dF9yZXZpc2lvbl9jZXJ0KHJldmlzaW9uPGNlcnQ+IGNvbnN0ICYgY2VydCk7CgogIC8vIHRoaXMg
dmFyaWFudCBoYXMgdG8gYmUgcmF0aGVyIGNvYXJzZSBhbmQgZmFzdCwgZm9yIG5ldHN5bmMncyB1
c2UKICB2b2lkIGdldF9yZXZpc2lvbl9jZXJ0X2luZGV4KHN0ZDo6dmVjdG9yPCBzdGQ6OnBhaXI8
aGV4ZW5jPGlkPiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6cGFpcjxyZXZp
c2lvbl9pZCwgcnNhX2tleXBhaXJfaWQ+ID4gPiAmIGlkeCk7CgogIHZvaWQgZ2V0X3JldmlzaW9u
X2NlcnRzKGNlcnRfbmFtZSBjb25zdCAmIG5hbWUsIAogICAgICAgICAgICAgICAgICAgICAgICAg
c3RkOjp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQgZ2V0X3Jldmlz
aW9uX2NlcnRzKHJldmlzaW9uX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICAgICAgICAg
ICAgY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6
OnZlY3RvcjwgcmV2aXNpb248Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRfcmV2aXNpb25f
Y2VydHMoY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgIGJh
c2U2NDxjZXJ0X3ZhbHVlPiBjb25zdCAmIHZhbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICBz
dGQ6OnZlY3RvcjwgcmV2aXNpb248Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRfcmV2aXNp
b25fY2VydHMocmV2aXNpb25faWQgY29uc3QgJiBpZCwgCiAgICAgICAgICAgICAgICAgICAgICAg
ICBjZXJ0X25hbWUgY29uc3QgJiBuYW1lLCAKICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U2
NDxjZXJ0X3ZhbHVlPiBjb25zdCAmIHZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgc3Rk
Ojp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQgZ2V0X3JldmlzaW9u
X2NlcnRzKHJldmlzaW9uX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICAgICAgICAgICAg
c3RkOjp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQgZ2V0X3Jldmlz
aW9uX2NlcnQoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gsCiAgICAgICAgICAgICAgICAgICAgICAg
ICByZXZpc2lvbjxjZXJ0PiAmIGNlcnQpOwogIAogIHZvaWQgZ2V0X21hbmlmZXN0X2NlcnRzKG1h
bmlmZXN0X2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6dmVj
dG9yPCBtYW5pZmVzdDxjZXJ0PiA+ICYgY2VydHMpOwoKICB2b2lkIGdldF9tYW5pZmVzdF9jZXJ0
cyhjZXJ0X25hbWUgY29uc3QgJiBuYW1lLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6
OnZlY3RvcjwgbWFuaWZlc3Q8Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRfbWFuaWZlc3Rf
Y2VydHMobWFuaWZlc3RfaWQgY29uc3QgJiBpZCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
Y2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RkOjp2
ZWN0b3I8IG1hbmlmZXN0PGNlcnQ+ID4gJiBjZXJ0cyk7CiAgCiAgdm9pZCBnZXRfbWFuaWZlc3Rf
Y2VydChoZXhlbmM8aWQ+IGNvbnN0ICYgaGFzaCwKICAgICAgICAgICAgICAgICAgICAgICAgIG1h
bmlmZXN0PGNlcnQ+ICYgY2VydCk7CgogIAogIC8vIG1lcmtsZSB0cmVlIHN0dWZmCgogIGJvb2wg
bWVya2xlX25vZGVfZXhpc3RzKHN0ZDo6c3RyaW5nIGNvbnN0ICYgdHlwZSwKICAgICAgICAgICAg
ICAgICAgICAgICAgICB1dGY4IGNvbnN0ICYgY29sbGVjdGlvbiwgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgc2l6ZV90IGxldmVsLAogICAgICAgICAgICAgICAgICAgICAgICAgIGhleGVuYzxw
cmVmaXg+IGNvbnN0ICYgcHJlZml4KTsKICAKICB2b2lkIGdldF9tZXJrbGVfbm9kZShzdGQ6OnN0
cmluZyBjb25zdCAmIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgdXRmOCBjb25zdCAmIGNv
bGxlY3Rpb24sIAogICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCBsZXZlbCwKICAgICAgICAg
ICAgICAgICAgICAgICBoZXhlbmM8cHJlZml4PiBjb25zdCAmIHByZWZpeCwKICAgICAgICAgICAg
ICAgICAgICAgICBiYXNlNjQ8bWVya2xlPiAmIG5vZGUpOwoKICB2b2lkIHB1dF9tZXJrbGVfbm9k
ZShzdGQ6OnN0cmluZyBjb25zdCAmIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgdXRmOCBj
b25zdCAmIGNvbGxlY3Rpb24sIAogICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCBsZXZlbCwK
ICAgICAgICAgICAgICAgICAgICAgICBoZXhlbmM8cHJlZml4PiBjb25zdCAmIHByZWZpeCwKICAg
ICAgICAgICAgICAgICAgICAgICBiYXNlNjQ8bWVya2xlPiBjb25zdCAmIG5vZGUpOwoKICB2b2lk
IGVyYXNlX21lcmtsZV9ub2RlcyhzdGQ6OnN0cmluZyBjb25zdCAmIHR5cGUsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgdXRmOCBjb25zdCAmIGNvbGxlY3Rpb24pOwoKICAvLyBjb21wbGV0aW9u
IHN0dWZmCgogIHZvaWQgY29tcGxldGUoc3RkOjpzdHJpbmcgY29uc3QgJiBwYXJ0aWFsLAogICAg
ICAgICAgICAgICAgc3RkOjpzZXQ8cmV2aXNpb25faWQ+ICYgY29tcGxldGlvbnMpOwoKICB2b2lk
IGNvbXBsZXRlKHN0ZDo6c3RyaW5nIGNvbnN0ICYgcGFydGlhbCwKICAgICAgICAgICAgICAgIHN0
ZDo6c2V0PG1hbmlmZXN0X2lkPiAmIGNvbXBsZXRpb25zKTsKICAKICB2b2lkIGNvbXBsZXRlKHN0
ZDo6c3RyaW5nIGNvbnN0ICYgcGFydGlhbCwKICAgICAgICAgICAgICAgIHN0ZDo6c2V0PGZpbGVf
aWQ+ICYgY29tcGxldGlvbnMpOwoKICB2b2lkIGNvbXBsZXRlKGNvbW1hbmRzOjpzZWxlY3Rvcl90
eXBlIHR5LAogICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiBwYXJ0aWFsLAogICAg
ICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjpwYWlyPGNvbW1hbmRzOjpzZWxlY3Rvcl90eXBl
LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZz4gPiBj
b25zdCAmIGxpbWl0LAogICAgICAgICAgICAgICAgc3RkOjpzZXQ8c3RkOjpzdHJpbmc+ICYgY29t
cGxldGlvbnMpOwogIAogIH5kYXRhYmFzZSgpOwoKfTsKCi8vIHRyYW5zYWN0aW9uIGd1YXJkcyBu
ZXN0LiBhY3F1aXJlIG9uZSBpbiBhbnkgc2NvcGUgeW91J2QgbGlrZQovLyB0cmFuc2FjdGlvbi1w
cm90ZWN0ZWQsIGFuZCBpdCdsbCBtYWtlIHN1cmUgdGhlIGRiIGFib3J0cyBhCi8vIHR4biBpZiB0
aGVyZSdzIGFueSBleGNlcHRpb24gYmVmb3JlIHlvdSBjYWxsIGNvbW1pdCgpCgpjbGFzcyB0cmFu
c2FjdGlvbl9ndWFyZAp7CiAgYm9vbCBjb21taXR0ZWQ7CiAgZGF0YWJhc2UgJiBkYjsKcHVibGlj
OgogIHRyYW5zYWN0aW9uX2d1YXJkKGRhdGFiYXNlICYgZCk7CiAgfnRyYW5zYWN0aW9uX2d1YXJk
KCk7CiAgdm9pZCBjb21taXQoKTsKfTsKCgoKI2VuZGlmIC8vIF9fREFUQUJBU0VfSEhfXwo=
])

AT_DATA(left.b64, [
I2lmbmRlZiBfX0RBVEFCQVNFX0hIX18KI2RlZmluZSBfX0RBVEFCQVNFX0hIX18KCi8vIGNvcHly
aWdodCAoQykgMjAwMiwgMjAwMyBncmF5ZG9uIGhvYXJlIDxncmF5ZG9uQHBvYm94LmNvbT4KLy8g
YWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gbGljZW5zZWQgdG8gdGhlIHB1YmxpYyB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBHUEwgKD49IDIpCi8vIHNlZSB0aGUgZmlsZSBDT1BZSU5HIGZvciBk
ZXRhaWxzCgpzdHJ1Y3Qgc3FsaXRlMzsKc3RydWN0IGNlcnQ7CgojaW5jbHVkZSA8dmVjdG9yPgoj
aW5jbHVkZSA8c2V0PgojaW5jbHVkZSA8bWFwPgojaW5jbHVkZSA8c3RyaW5nPgoKI2luY2x1ZGUg
PGJvb3N0L2ZpbGVzeXN0ZW0vcGF0aC5ocHA+CgojaW5jbHVkZSAiY29tbWFuZHMuaGgiCiNpbmNs
dWRlICJtYW5pZmVzdC5oaCIKI2luY2x1ZGUgIm51bWVyaWNfdm9jYWIuaGgiCiNpbmNsdWRlICJ2
b2NhYi5oaCIKCnN0cnVjdCByZXZpc2lvbl9zZXQ7CgovLyB0aGlzIGZpbGUgZGVmaW5lcyBhIHB1
YmxpYywgdHlwZWQgaW50ZXJmYWNlIHRvIHRoZSBkYXRhYmFzZS4KLy8gdGhlIGRhdGFiYXNlIGNs
YXNzIGVuY2Fwc3VsYXRlcyBhbGwga25vd2xlZGdlIGFib3V0IHNxbGl0ZSwKLy8gdGhlIHNjaGVt
YSwgYW5kIGFsbCBTUUwgc3RhdGVtZW50cyB1c2VkIHRvIGFjY2VzcyB0aGUgc2NoZW1hLgovLwov
LyBvbmUgdGhpbmcgd2hpY2ggaXMgcmF0aGVyIGltcG9ydGFudCB0byBub3RlIGlzIHRoYXQgdGhp
cyBmaWxlCi8vIGRlYWxzIHdpdGggdHdvIHNvcnRzIG9mIHZlcnNpb24gcmVsYXRpb25zaGlwcy4g
dGhlIHZlcnNpb25zCi8vIHN0b3JlZCBpbiB0aGUgZGF0YWJhc2UgYXJlIGFsbCAqYmFja3dhcmRz
KiBmcm9tIHRob3NlIHRoZSBwcm9ncmFtCi8vIHNlZXMuIHNvIGZvciBleGFtcGxlIGlmIHlvdSBo
YXZlIHR3byB2ZXJzaW9ucyBvZiBhIGZpbGUKLy8gCi8vIGZpbGUuMSwgZmlsZS4yCi8vCi8vIHdo
ZXJlIGZpbGUuMiB3YXMgYSBtb2RpZmljYXRpb24gb2YgZmlsZS4xLCB0aGVuIGFzIGZhciBhcyB0
aGUgcmVzdCBvZgovLyB0aGUgYXBwbGljYXRpb24gaXMgY29uY2VybmVkIC0tIGFuZCB0aGUgYW5j
ZXN0cnkgZ3JhcGggLS0gZmlsZS4xIGlzIHRoZQovLyAib2xkIiB2ZXJzaW9uIGFuZCBmaWxlLjIg
aXMgdGhlICJuZXciIHZlcnNpb24uIG5vdGUgdGhlIHVzZSBvZiB0ZXJtcwovLyB3aGljaCBkZXNj
cmliZSB0aW1lLCBhbmQgdGhlIHNlcXVlbmNlIG9mIGVkaXRzIGEgdXNlciBtYWtlcyB0byBhCi8v
IGZpbGUuIHRob3NlIGFyZSBhbmNlc3RyeSB0ZXJtcy4gd2hlbiB0aGUgYXBwbGljYXRpb24gY29t
cG9zZXMgYQovLyBwYXRjaHNldCwgZm9yIGV4YW1wbGUsIGl0J2xsIGNvbnRhaW4gdGhlIGRpZmYg
ZGVsdGEoZmlsZS4xLCBmaWxlLjIpCi8vCi8vIGZyb20gdGhlIGRhdGFiYXNlJ3MgcGVyc3BlY3Rp
dmUsIGhvd2V2ZXIsIGZpbGUuMSBpcyB0aGUgZGVyaXZlZCB2ZXJzaW9uLAovLyBhbmQgZmlsZS4y
IGlzIHRoZSBiYXNlIHZlcnNpb24uIHRoZSBiYXNlIHZlcnNpb24gaXMgc3RvcmVkIGluIHRoZQov
LyAiZmlsZXMiIHRhYmxlLCBhbmQgdGhlICpyZXZlcnNlKiBkaWZmIGRlbHRhKGZpbGUuMiwgZmls
ZS4xKSBpcyBzdG9yZWQgaW4KLy8gdGhlICJmaWxlX2RlbHRhcyIgdGFibGUsIHVuZGVyIHRoZSBp
ZCBvZiBmaWxlLjEsIHdpdGggdGhlIGlkIG9mIGZpbGUuMgovLyBsaXN0ZWQgYXMgaXRzIGJhc2Uu
IG5vdGUgdGhlIHVzZSBvZiB0aGUgdGVybXMgd2hpY2ggZGVzY3JpYmUKLy8gcmVjb25zdHJ1Y3Rp
b247IHRob3NlIGFyZSBzdG9yYWdlLXN5c3RlbSB0ZXJtcy4KLy8KLy8gdGhlIGludGVyZmFjZSAq
dG8qIHRoZSBkYXRhYmFzZSwgYW5kIHRoZSBhbmNlc3RyeSB2ZXJzaW9uIGdyYXBocywgdXNlCi8v
IHRoZSBvbGQgLyBuZXcgbWV0YXBob3Igb2YgYW5jZXN0cnksIGJ1dCB3aXRoaW4gdGhlIGRhdGFi
YXNlIChpbmNsdWRpbmcKLy8gdGhlIHByaXZhdGUgaGVscGVyIG1ldGhvZHMsIGFuZCB0aGUgc3Rv
cmFnZSB2ZXJzaW9uIGdyYXBocykgdGhlCi8vIGJhc2UvZGVyaXZlZCBzdG9yYWdlIG1ldGFwaG9y
IGlzIHVzZWQuIHRoZSBvbmx5IHJlYWwgd2F5IHRvIHRlbGwgd2hpY2gKLy8gaXMgd2hpY2ggaXMg
dG8gbG9vayBhdCB0aGUgcGFyYW1ldGVyIG5hbWVzIGFuZCBjb2RlLiBJIG1pZ2h0IHRyeSB0bwov
LyBleHByZXNzIHRoaXMgaW4gdGhlIHR5cGUgc3lzdGVtIHNvbWUgZGF5LCBidXQgbm90IHByZXNl
bnRseS4KLy8KLy8gdGhlIGtleSBwaHJhc2UgdG8ga2VlcCByZXBlYXRpbmcgd2hlbiB3b3JraW5n
IG9uIHRoaXMgY29kZSBpczoKLy8gCi8vICJiYXNlIGZpbGVzIGFyZSBuZXcsIGRlcml2ZWQgZmls
ZXMgYXJlIG9sZCIKLy8KLy8gaXQgbWFrZXMgdGhlIGNvZGUgY29uZnVzaW5nLCBJIGtub3cuIHRo
aXMgaXMgcG9zc2libHkgdGhlIHdvcnN0IHBhcnQgb2YKLy8gdGhlIHByb2dyYW0uIEkgZG9uJ3Qg
a25vdyBpZiB0aGVyZSdzIGFueSB3YXkgdG8gbWFrZSBpdCBjbGVhcmVyLgoKY2xhc3MgdHJhbnNh
Y3Rpb25fZ3VhcmQ7CnN0cnVjdCBwb3N0aW5nOwpzdHJ1Y3QgYXBwX3N0YXRlOwoKY2xhc3MgZGF0
YWJhc2UKewogIGZzOjpwYXRoIGZpbGVuYW1lOwogIHN0ZDo6c3RyaW5nIGNvbnN0IHNjaGVtYTsK
ICB2b2lkIGNoZWNrX3NjaGVtYSgpOwoKICBzdHJ1Y3QgYXBwX3N0YXRlICogX19hcHA7CiAgc3Ry
dWN0IHNxbGl0ZTMgKiBfX3NxbDsKICBzdHJ1Y3Qgc3FsaXRlMyAqIHNxbChib29sIGluaXQgPSBm
YWxzZSk7CiAgaW50IHRyYW5zYWN0aW9uX2xldmVsOwoKICB2b2lkIGluc3RhbGxfZnVuY3Rpb25z
KGFwcF9zdGF0ZSAqIGFwcCk7CiAgdm9pZCBpbnN0YWxsX3ZpZXdzKCk7CgogIHR5cGVkZWYgc3Rk
Ojp2ZWN0b3I8IHN0ZDo6dmVjdG9yPHN0ZDo6c3RyaW5nPiA+IHJlc3VsdHM7CiAgdm9pZCBleGVj
dXRlKGNoYXIgY29uc3QgKiBxdWVyeSwgLi4uKTsKICB2b2lkIGZldGNoKHJlc3VsdHMgJiByZXMs
IAogICAgICAgICAgICAgaW50IGNvbnN0IHdhbnRfY29scywgCiAgICAgICAgICAgICBpbnQgY29u
c3Qgd2FudF9yb3dzLCAKICAgICAgICAgICAgIGNoYXIgY29uc3QgKiBxdWVyeSwgLi4uKTsKCiAg
Ym9vbCBleGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkZW50LCAKICAgICAgICAgICAgICBzdGQ6
OnN0cmluZyBjb25zdCAmIHRhYmxlKTsKICBib29sIGRlbHRhX2V4aXN0cyhoZXhlbmM8aWQ+IGNv
bnN0ICYgaWRlbnQsCiAgICAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJs
ZSk7CiAgYm9vbCBkZWx0YV9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkZW50LAogICAgICAg
ICAgICAgICAgICAgIGhleGVuYzxpZD4gY29uc3QgJiBiYXNlLAogICAgICAgICAgICAgICAgICAg
IHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOwoKICB1bnNpZ25lZCBsb25nIGNvdW50KHN0ZDo6
c3RyaW5nIGNvbnN0ICYgdGFibGUpOwoKICB2b2lkIGdldF9pZHMoc3RkOjpzdHJpbmcgY29uc3Qg
JiB0YWJsZSwgc3RkOjpzZXQ8IGhleGVuYzxpZD4gPiAmIGlkcyk7IAoKICB2b2lkIGdldChoZXhl
bmM8aWQ+IGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgIGJhc2U2NDwgZ3ppcDxkYXRhPiA+ICYg
ZGF0LAogICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOwogIHZvaWQgZ2V0X2Rl
bHRhKGhleGVuYzxpZD4gY29uc3QgJiBpZGVudCwKICAgICAgICAgICAgICAgICBoZXhlbmM8aWQ+
IGNvbnN0ICYgYmFzZSwKICAgICAgICAgICAgICAgICBiYXNlNjQ8IGd6aXA8ZGVsdGE+ID4gJiBk
ZWwsCiAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7CiAgdm9pZCBn
ZXRfdmVyc2lvbihoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgICBiYXNl
NjQ8IGd6aXA8ZGF0YT4gPiAmIGRhdCwKICAgICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNv
bnN0ICYgZGF0YV90YWJsZSwKICAgICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYg
ZGVsdGFfdGFibGUpOwogIAogIHZvaWQgcHV0KGhleGVuYzxpZD4gY29uc3QgJiBuZXdfaWQsCiAg
ICAgICAgICAgYmFzZTY0PCBnemlwPGRhdGE+ID4gY29uc3QgJiBkYXQsCiAgICAgICAgICAgc3Rk
OjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7CiAgdm9pZCBkcm9wKGhleGVuYzxpZD4gY29uc3QgJiBi
YXNlLAogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxlKTsKICB2b2lkIHB1dF9k
ZWx0YShoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgaGV4ZW5jPGlkPiBj
b25zdCAmIGJhc2UsCiAgICAgICAgICAgICAgICAgYmFzZTY0PCBnemlwPGRlbHRhPiA+IGNvbnN0
ICYgZGVsLAogICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOwogIHZv
aWQgcHV0X3ZlcnNpb24oaGV4ZW5jPGlkPiBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAg
ICAgIGhleGVuYzxpZD4gY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAgICAgICAgICBiYXNlNjQ8
IGd6aXA8ZGVsdGE+ID4gY29uc3QgJiBkZWwsCiAgICAgICAgICAgICAgICAgICBzdGQ6OnN0cmlu
ZyBjb25zdCAmIGRhdGFfdGFibGUsCiAgICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25z
dCAmIGRlbHRhX3RhYmxlKTsKICB2b2lkIHB1dF9yZXZlcnNlX3ZlcnNpb24oaGV4ZW5jPGlkPiBj
b25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV4ZW5jPGlkPiBjb25z
dCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTY0PCBnemlwPGRlbHRh
PiA+IGNvbnN0ICYgcmV2ZXJzZV9kZWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6
c3RyaW5nIGNvbnN0ICYgZGF0YV90YWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Rk
OjpzdHJpbmcgY29uc3QgJiBkZWx0YV90YWJsZSk7CgogIHZvaWQgZ2V0X2tleXMoc3RkOjpzdHJp
bmcgY29uc3QgJiB0YWJsZSwgc3RkOjp2ZWN0b3I8cnNhX2tleXBhaXJfaWQ+ICYga2V5cyk7Cgog
IGJvb2wgY2VydF9leGlzdHMoY2VydCBjb25zdCAmIHQsCiAgICAgICAgICAgICAgICAgIHN0ZDo6
c3RyaW5nIGNvbnN0ICYgdGFibGUpOwogIHZvaWQgcHV0X2NlcnQoY2VydCBjb25zdCAmIHQsIHN0
ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOyAgCiAgdm9pZCByZXN1bHRzX3RvX2NlcnRzKHJlc3Vs
dHMgY29uc3QgJiByZXMsCiAgICAgICAgICAgICAgICAgICAgICAgc3RkOjp2ZWN0b3I8Y2VydD4g
JiBjZXJ0cyk7CgogIHZvaWQgZ2V0X2NlcnRzKHN0ZDo6dmVjdG9yPCBjZXJ0ID4gJiBjZXJ0cywK
ICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxlKTsgIAoKICB2b2lkIGdl
dF9jZXJ0cyhoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICAgIHN0ZDo6dmVj
dG9yPCBjZXJ0ID4gJiBjZXJ0cywKICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAm
IHRhYmxlKTsgIAoKICB2b2lkIGdldF9jZXJ0cyhjZXJ0X25hbWUgY29uc3QgJiBuYW1lLCAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgc3RkOjp2ZWN0b3I8IGNlcnQgPiAmIGNlcnRzLAog
ICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOwoKICB2b2lkIGdldF9j
ZXJ0cyhoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgY2VydF9uYW1lIGNv
bnN0ICYgbmFtZSwKICAgICAgICAgICAgICAgICBzdGQ6OnZlY3RvcjwgY2VydCA+ICYgY2VydHMs
CiAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7ICAKCiAgdm9pZCBn
ZXRfY2VydHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkLAogICAgICAgICAgICAgICAgIGNlcnRfbmFt
ZSBjb25zdCAmIG5hbWUsCiAgICAgICAgICAgICAgICAgYmFzZTY0PGNlcnRfdmFsdWU+IGNvbnN0
ICYgdmFsLCAKICAgICAgICAgICAgICAgICBzdGQ6OnZlY3RvcjwgY2VydCA+ICYgY2VydHMsCiAg
ICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7ICAKCiAgdm9pZCBnZXRf
Y2VydHMoY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwKICAgICAgICAgICAgICAgICBiYXNlNjQ8Y2Vy
dF92YWx1ZT4gY29uc3QgJiB2YWwsIAogICAgICAgICAgICAgICAgIHN0ZDo6dmVjdG9yPGNlcnQ+
ICYgY2VydHMsCiAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7Cgog
IHZvaWQgYmVnaW5fdHJhbnNhY3Rpb24oKTsKICB2b2lkIGNvbW1pdF90cmFuc2FjdGlvbigpOwog
IHZvaWQgcm9sbGJhY2tfdHJhbnNhY3Rpb24oKTsKICBmcmllbmQgY2xhc3MgdHJhbnNhY3Rpb25f
Z3VhcmQ7CiAgZnJpZW5kIHZvaWQgcmNzX3B1dF9yYXdfZmlsZV9lZGdlKGhleGVuYzxpZD4gY29u
c3QgJiBvbGRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhleGVuYzxp
ZD4gY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJh
c2U2NDwgZ3ppcDxkZWx0YT4gPiBjb25zdCAmIGRlbCwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZGF0YWJhc2UgJiBkYik7CiAgZnJpZW5kIHZvaWQgcmNzX3B1dF9yYXdfbWFu
aWZlc3RfZWRnZShoZXhlbmM8aWQ+IGNvbnN0ICYgb2xkX2lkLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaGV4ZW5jPGlkPiBjb25zdCAmIG5ld19pZCwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U2NDwgZ3ppcDxkZWx0YT4gPiBjb25z
dCAmIGRlbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNl
ICYgZGIpOwoKcHVibGljOgoKICBkYXRhYmFzZShmczo6cGF0aCBjb25zdCAmIGZpbGUpOwoKICB2
b2lkIHNldF9maWxlbmFtZShmczo6cGF0aCBjb25zdCAmIGZpbGUpOwogIHZvaWQgaW5pdGlhbGl6
ZSgpOwogIHZvaWQgZGVidWcoc3RkOjpzdHJpbmcgY29uc3QgJiBzcWwsIHN0ZDo6b3N0cmVhbSAm
IG91dCk7CiAgdm9pZCBkdW1wKHN0ZDo6b3N0cmVhbSAmKTsKICB2b2lkIGxvYWQoc3RkOjppc3Ry
ZWFtICYpOwogIHZvaWQgaW5mbyhzdGQ6Om9zdHJlYW0gJik7CiAgdm9pZCB2ZXJzaW9uKHN0ZDo6
b3N0cmVhbSAmKTsKICB2b2lkIG1pZ3JhdGUoKTsKICB2b2lkIHJlaGFzaCgpOwogIHZvaWQgZW5z
dXJlX29wZW4oKTsKICAKICBib29sIGZpbGVfdmVyc2lvbl9leGlzdHMoZmlsZV9pZCBjb25zdCAm
IGlkKTsKICBib29sIG1hbmlmZXN0X3ZlcnNpb25fZXhpc3RzKG1hbmlmZXN0X2lkIGNvbnN0ICYg
aWQpOwogIGJvb2wgcmV2aXNpb25fZXhpc3RzKHJldmlzaW9uX2lkIGNvbnN0ICYgaWQpOwoKICB2
b2lkIGdldF9maWxlX2lkcyhzdGQ6OnNldDxmaWxlX2lkPiAmIGlkcyk7CiAgdm9pZCBnZXRfbWFu
aWZlc3RfaWRzKHN0ZDo6c2V0PG1hbmlmZXN0X2lkPiAmIGlkcyk7CiAgdm9pZCBnZXRfcmV2aXNp
b25faWRzKHN0ZDo6c2V0PHJldmlzaW9uX2lkPiAmIGlkcyk7CgogIHZvaWQgc2V0X2FwcChhcHBf
c3RhdGUgKiBhcHApOwogIAogIC8vIGdldCBwbGFpbiB2ZXJzaW9uIGlmIGl0IGV4aXN0cywgb3Ig
cmVjb25zdHJ1Y3QgdmVyc2lvbgogIC8vIGZyb20gZGVsdGFzIChpZiB0aGV5IGV4aXN0KQogIHZv
aWQgZ2V0X2ZpbGVfdmVyc2lvbihmaWxlX2lkIGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAg
ICAgICAgIGZpbGVfZGF0YSAmIGRhdCk7CgogIC8vIGdldCBmaWxlIGRlbHRhIGlmIGl0IGV4aXN0
cywgZWxzZSBjYWxjdWxhdGUgaXQuCiAgLy8gYm90aCBtYW5pZmVzdHMgbXVzdCBleGlzdC4KICB2
b2lkIGdldF9maWxlX2RlbHRhKGZpbGVfaWQgY29uc3QgJiBzcmMsCiAgICAgICAgICAgICAgICAg
ICAgICBmaWxlX2lkIGNvbnN0ICYgZHN0LAogICAgICAgICAgICAgICAgICAgICAgZmlsZV9kZWx0
YSAmIGRlbCk7CgogIC8vIHB1dCBmaWxlIHcvbyBwcmVkZWNlc3NvciBpbnRvIGRiCiAgdm9pZCBw
dXRfZmlsZShmaWxlX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgICAgICAgZmlsZV9kYXRh
IGNvbnN0ICYgZGF0KTsKCiAgLy8gc3RvcmUgbmV3IHZlcnNpb24gYW5kIHVwZGF0ZSBvbGQgdmVy
c2lvbiB0byBiZSBhIGRlbHRhCiAgdm9pZCBwdXRfZmlsZV92ZXJzaW9uKGZpbGVfaWQgY29uc3Qg
JiBvbGRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfaWQgY29uc3QgJiBuZXdfaWQs
CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfZGVsdGEgY29uc3QgJiBkZWwpOwoKICAvLyBs
b2FkIGluIGEgImRpcmVjdCIgbmV3IC0+IG9sZCByZXZlcnNlIGVkZ2UgKHVzZWQgZHVyaW5nCiAg
Ly8gbmV0c3luYyBhbmQgQ1ZTIGxvYWQtaW4pCiAgdm9pZCBwdXRfZmlsZV9yZXZlcnNlX3ZlcnNp
b24oZmlsZV9pZCBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBmaWxlX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGZpbGVfZGVsdGEgY29uc3QgJiBkZWwpOwoKICAvLyBnZXQgcGxhaW4gdmVyc2lvbiBpZiBpdCBl
eGlzdHMsIG9yIHJlY29uc3RydWN0IHZlcnNpb24KICAvLyBmcm9tIGRlbHRhcyAoaWYgdGhleSBl
eGlzdCkuIAogIHZvaWQgZ2V0X21hbmlmZXN0X3ZlcnNpb24obWFuaWZlc3RfaWQgY29uc3QgJiBp
ZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2RhdGEgJiBkYXQpOwoKICAv
LyBnZXQgYSBjb25zdHJ1Y3RlZCBtYW5pZmVzdAogIHZvaWQgZ2V0X21hbmlmZXN0KG1hbmlmZXN0
X2lkIGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3RfbWFwICYgbW0pOwoK
ICAvLyBnZXQgbWFuaWZlc3QgZGVsdGEgaWYgaXQgZXhpc3RzLCBlbHNlIGNhbGN1bGF0ZSBpdC4K
ICAvLyBib3RoIG1hbmlmZXN0cyBtdXN0IGV4aXN0LgogIHZvaWQgZ2V0X21hbmlmZXN0X2RlbHRh
KG1hbmlmZXN0X2lkIGNvbnN0ICYgc3JjLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlm
ZXN0X2lkIGNvbnN0ICYgZHN0LAogICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2Rl
bHRhICYgZGVsKTsKCiAgLy8gcHV0IG1hbmlmZXN0IHcvbyBwcmVkZWNlc3NvciBpbnRvIGRiCiAg
dm9pZCBwdXRfbWFuaWZlc3QobWFuaWZlc3RfaWQgY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAg
ICAgICAgICAgbWFuaWZlc3RfZGF0YSBjb25zdCAmIGRhdCk7CgogIC8vIHN0b3JlIG5ldyB2ZXJz
aW9uIGFuZCB1cGRhdGUgb2xkIHZlcnNpb24gdG8gYmUgYSBkZWx0YQogIHZvaWQgcHV0X21hbmlm
ZXN0X3ZlcnNpb24obWFuaWZlc3RfaWQgY29uc3QgJiBvbGRfaWQsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBtYW5pZmVzdF9pZCBjb25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG1hbmlmZXN0X2RlbHRhIGNvbnN0ICYgZGVsKTsKCiAgLy8gbG9hZCBpbiBhICJk
aXJlY3QiIG5ldyAtPiBvbGQgcmV2ZXJzZSBlZGdlICh1c2VkIGR1cmluZwogIC8vIG5ldHN5bmMg
YW5kIENWUyBsb2FkLWluKQogIHZvaWQgcHV0X21hbmlmZXN0X3JldmVyc2VfdmVyc2lvbihtYW5p
ZmVzdF9pZCBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbWFuaWZlc3RfaWQgY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG1hbmlmZXN0X2RlbHRhIGNvbnN0ICYgZGVsKTsKCgogIHZvaWQgZ2V0X3Jldmlz
aW9uX2FuY2VzdHJ5KHN0ZDo6bXVsdGltYXA8cmV2aXNpb25faWQsIHJldmlzaW9uX2lkPiAmIGdy
YXBoKTsKCiAgdm9pZCBnZXRfcmV2aXNpb25fcGFyZW50cyhyZXZpc2lvbl9pZCBjb25zdCAmIGlk
LAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnNldDxyZXZpc2lvbl9pZD4gJiBwYXJl
bnRzKTsKCiAgdm9pZCBnZXRfcmV2aXNpb25fY2hpbGRyZW4ocmV2aXNpb25faWQgY29uc3QgJiBp
ZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnNldDxyZXZpc2lvbl9pZD4gJiBj
aGlsZHJlbik7CgogIHZvaWQgZ2V0X3JldmlzaW9uX21hbmlmZXN0KHJldmlzaW9uX2lkIGNvbnN0
ICYgY2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3RfaWQgJiBtaWQpOwoK
ICB2b2lkIGdldF9yZXZpc2lvbihyZXZpc2lvbl9pZCBjb25zdCAmIGlkLAogICAgICAgICAgICAg
ICAgICAgcmV2aXNpb25fc2V0ICYgY3MpOwoKICB2b2lkIGdldF9yZXZpc2lvbihyZXZpc2lvbl9p
ZCBjb25zdCAmIGlkLAogICAgICAgICAgICAgICAgICAgcmV2aXNpb25fZGF0YSAmIGRhdCk7Cgog
IHZvaWQgcHV0X3JldmlzaW9uKHJldmlzaW9uX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAg
ICAgICAgICAgcmV2aXNpb25fc2V0IGNvbnN0ICYgY3MpOwoKICB2b2lkIHB1dF9yZXZpc2lvbihy
ZXZpc2lvbl9pZCBjb25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAgICAgICByZXZpc2lvbl9k
YXRhIGNvbnN0ICYgZGF0KTsKICAKICB2b2lkIGRlbGV0ZV9leGlzdGluZ19yZXZzX2FuZF9jZXJ0
cygpOwoKICAvLyBjcnlwdG8ga2V5IC8gY2VydCBvcGVyYXRpb25zCgogIHZvaWQgZ2V0X2tleV9p
ZHMoc3RkOjpzdHJpbmcgY29uc3QgJiBwYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgc3RkOjp2
ZWN0b3I8cnNhX2tleXBhaXJfaWQ+ICYgcHVia2V5cywKICAgICAgICAgICAgICAgICAgIHN0ZDo6
dmVjdG9yPHJzYV9rZXlwYWlyX2lkPiAmIHByaXZrZXlzKTsKCiAgdm9pZCBnZXRfcHJpdmF0ZV9r
ZXlzKHN0ZDo6dmVjdG9yPHJzYV9rZXlwYWlyX2lkPiAmIHByaXZrZXlzKTsKICB2b2lkIGdldF9w
dWJsaWNfa2V5cyhzdGQ6OnZlY3Rvcjxyc2Ffa2V5cGFpcl9pZD4gJiBwdWJrZXlzKTsKCiAgYm9v
bCBrZXlfZXhpc3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwoKICBib29sIHB1YmxpY19r
ZXlfZXhpc3RzKGhleGVuYzxpZD4gY29uc3QgJiBoYXNoKTsKICBib29sIHB1YmxpY19rZXlfZXhp
c3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwogIGJvb2wgcHJpdmF0ZV9rZXlfZXhpc3Rz
KHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwogIAogIHZvaWQgZ2V0X3B1YmtleShoZXhlbmM8
aWQ+IGNvbnN0ICYgaGFzaCwgCiAgICAgICAgICAgICAgICAgIHJzYV9rZXlwYWlyX2lkICYgaWQs
CiAgICAgICAgICAgICAgICAgIGJhc2U2NDxyc2FfcHViX2tleT4gJiBwdWJfZW5jb2RlZCk7Cgog
IHZvaWQgZ2V0X2tleShyc2Ffa2V5cGFpcl9pZCBjb25zdCAmIGlkLCAKICAgICAgICAgICAgICAg
YmFzZTY0PHJzYV9wdWJfa2V5PiAmIHB1Yl9lbmNvZGVkKTsKCiAgdm9pZCBnZXRfa2V5KHJzYV9r
ZXlwYWlyX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICBiYXNlNjQ8IGFyYzQ8cnNhX3By
aXZfa2V5PiA+ICYgcHJpdl9lbmNvZGVkKTsKCiAgdm9pZCBwdXRfa2V5KHJzYV9rZXlwYWlyX2lk
IGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICBiYXNlNjQ8cnNhX3B1Yl9rZXk+IGNvbnN0ICYg
cHViX2VuY29kZWQpOwogIAogIHZvaWQgcHV0X2tleShyc2Ffa2V5cGFpcl9pZCBjb25zdCAmIGlk
LCAKICAgICAgICAgICAgICAgYmFzZTY0PCBhcmM0PHJzYV9wcml2X2tleT4gPiBjb25zdCAmIHBy
aXZfZW5jb2RlZCk7CiAgCiAgdm9pZCBwdXRfa2V5X3BhaXIocnNhX2tleXBhaXJfaWQgY29uc3Qg
JiBwdWJfaWQsIAogICAgICAgICAgICAgICAgICAgIGJhc2U2NDxyc2FfcHViX2tleT4gY29uc3Qg
JiBwdWJfZW5jb2RlZCwKICAgICAgICAgICAgICAgICAgICBiYXNlNjQ8IGFyYzQ8cnNhX3ByaXZf
a2V5PiA+IGNvbnN0ICYgcHJpdl9lbmNvZGVkKTsKCiAgdm9pZCBkZWxldGVfcHJpdmF0ZV9rZXko
cnNhX2tleXBhaXJfaWQgY29uc3QgJiBwdWJfaWQpOwoKICAvLyBub3RlOiB0aGlzIHNlY3Rpb24g
aXMgcmlkaWN1bG91cy4gcGxlYXNlIGRvIHNvbWV0aGluZyBhYm91dCBpdC4KCiAgYm9vbCBtYW5p
ZmVzdF9jZXJ0X2V4aXN0cyhtYW5pZmVzdDxjZXJ0PiBjb25zdCAmIGNlcnQpOwogIGJvb2wgbWFu
aWZlc3RfY2VydF9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gpOwogIHZvaWQgcHV0X21h
bmlmZXN0X2NlcnQobWFuaWZlc3Q8Y2VydD4gY29uc3QgJiBjZXJ0KTsKCiAgYm9vbCByZXZpc2lv
bl9jZXJ0X2V4aXN0cyhyZXZpc2lvbjxjZXJ0PiBjb25zdCAmIGNlcnQpOwogIGJvb2wgcmV2aXNp
b25fY2VydF9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gpOwoKICB2b2lkIHB1dF9yZXZp
c2lvbl9jZXJ0KHJldmlzaW9uPGNlcnQ+IGNvbnN0ICYgY2VydCk7CgogIC8vIHRoaXMgdmFyaWFu
dCBoYXMgdG8gYmUgcmF0aGVyIGNvYXJzZSBhbmQgZmFzdCwgZm9yIG5ldHN5bmMncyB1c2UKICB2
b2lkIGdldF9yZXZpc2lvbl9jZXJ0X2luZGV4KHN0ZDo6dmVjdG9yPCBzdGQ6OnBhaXI8aGV4ZW5j
PGlkPiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6cGFpcjxyZXZpc2lvbl9p
ZCwgcnNhX2tleXBhaXJfaWQ+ID4gPiAmIGlkeCk7CgogIHZvaWQgZ2V0X3JldmlzaW9uX2NlcnRz
KHN0ZDo6dmVjdG9yPCByZXZpc2lvbjxjZXJ0PiA+ICYgY2VydHMpOwoKICB2b2lkIGdldF9yZXZp
c2lvbl9jZXJ0cyhjZXJ0X25hbWUgY29uc3QgJiBuYW1lLCAKICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdGQ6OnZlY3RvcjwgcmV2aXNpb248Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRf
cmV2aXNpb25fY2VydHMocmV2aXNpb25faWQgY29uc3QgJiBpZCwgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RkOjp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQgZ2V0X3Jl
dmlzaW9uX2NlcnRzKGNlcnRfbmFtZSBjb25zdCAmIG5hbWUsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgYmFzZTY0PGNlcnRfdmFsdWU+IGNvbnN0ICYgdmFsLCAKICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdGQ6OnZlY3RvcjwgcmV2aXNpb248Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBn
ZXRfcmV2aXNpb25fY2VydHMocmV2aXNpb25faWQgY29uc3QgJiBpZCwgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgYmFzZTY0PGNlcnRfdmFsdWU+IGNvbnN0ICYgdmFsdWUsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RkOjp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQg
Z2V0X3JldmlzaW9uX2NlcnRzKHJldmlzaW9uX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0ZDo6dmVjdG9yPCByZXZpc2lvbjxjZXJ0PiA+ICYgY2VydHMpOwoKICB2
b2lkIGdldF9yZXZpc2lvbl9jZXJ0KGhleGVuYzxpZD4gY29uc3QgJiBoYXNoLAogICAgICAgICAg
ICAgICAgICAgICAgICAgcmV2aXNpb248Y2VydD4gJiBjZXJ0KTsKICAKICB2b2lkIGdldF9tYW5p
ZmVzdF9jZXJ0cyhtYW5pZmVzdF9pZCBjb25zdCAmIGlkLCAKICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdGQ6OnZlY3RvcjwgbWFuaWZlc3Q8Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRf
bWFuaWZlc3RfY2VydHMoY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RkOjp2ZWN0b3I8IG1hbmlmZXN0PGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQg
Z2V0X21hbmlmZXN0X2NlcnRzKG1hbmlmZXN0X2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAg
ICAgICAgICAgICAgIGNlcnRfbmFtZSBjb25zdCAmIG5hbWUsIAogICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0ZDo6dmVjdG9yPCBtYW5pZmVzdDxjZXJ0PiA+ICYgY2VydHMpOwogIAogIHZvaWQg
Z2V0X21hbmlmZXN0X2NlcnQoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gsCiAgICAgICAgICAgICAg
ICAgICAgICAgICBtYW5pZmVzdDxjZXJ0PiAmIGNlcnQpOwoKICAvLyBlcG9jaHMgCgogIHZvaWQg
Z2V0X2Vwb2NocyhzdGQ6Om1hcDxjZXJ0X3ZhbHVlLCBlcG9jaF9kYXRhPiAmIGVwb2Nocyk7Cgog
IHZvaWQgZ2V0X2Vwb2NoKGVwb2NoX2lkIGNvbnN0ICYgZWlkLCBjZXJ0X3ZhbHVlICYgYnJhbmNo
LCBlcG9jaF9kYXRhICYgZXBvKTsKICAKICBib29sIGVwb2NoX2V4aXN0cyhlcG9jaF9pZCBjb25z
dCAmIGVpZCk7CgogIHZvaWQgc2V0X2Vwb2NoKGNlcnRfdmFsdWUgY29uc3QgJiBicmFuY2gsIGVw
b2NoX2RhdGEgY29uc3QgJiBlcG8pOyAgCgogIHZvaWQgY2xlYXJfZXBvY2goY2VydF92YWx1ZSBj
b25zdCAmIGJyYW5jaCk7CiAKICAvLyBjb21wbGV0aW9uIHN0dWZmCgogIHZvaWQgY29tcGxldGUo
c3RkOjpzdHJpbmcgY29uc3QgJiBwYXJ0aWFsLAogICAgICAgICAgICAgICAgc3RkOjpzZXQ8cmV2
aXNpb25faWQ+ICYgY29tcGxldGlvbnMpOwoKICB2b2lkIGNvbXBsZXRlKHN0ZDo6c3RyaW5nIGNv
bnN0ICYgcGFydGlhbCwKICAgICAgICAgICAgICAgIHN0ZDo6c2V0PG1hbmlmZXN0X2lkPiAmIGNv
bXBsZXRpb25zKTsKICAKICB2b2lkIGNvbXBsZXRlKHN0ZDo6c3RyaW5nIGNvbnN0ICYgcGFydGlh
bCwKICAgICAgICAgICAgICAgIHN0ZDo6c2V0PGZpbGVfaWQ+ICYgY29tcGxldGlvbnMpOwoKICB2
b2lkIGNvbXBsZXRlKGNvbW1hbmRzOjpzZWxlY3Rvcl90eXBlIHR5LAogICAgICAgICAgICAgICAg
c3RkOjpzdHJpbmcgY29uc3QgJiBwYXJ0aWFsLAogICAgICAgICAgICAgICAgc3RkOjp2ZWN0b3I8
c3RkOjpwYWlyPGNvbW1hbmRzOjpzZWxlY3Rvcl90eXBlLCAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZz4gPiBjb25zdCAmIGxpbWl0LAogICAgICAgICAg
ICAgICAgc3RkOjpzZXQ8c3RkOjpzdHJpbmc+ICYgY29tcGxldGlvbnMpOwogIAogIH5kYXRhYmFz
ZSgpOwoKfTsKCi8vIHRyYW5zYWN0aW9uIGd1YXJkcyBuZXN0LiBhY3F1aXJlIG9uZSBpbiBhbnkg
c2NvcGUgeW91J2QgbGlrZQovLyB0cmFuc2FjdGlvbi1wcm90ZWN0ZWQsIGFuZCBpdCdsbCBtYWtl
IHN1cmUgdGhlIGRiIGFib3J0cyBhCi8vIHR4biBpZiB0aGVyZSdzIGFueSBleGNlcHRpb24gYmVm
b3JlIHlvdSBjYWxsIGNvbW1pdCgpCgpjbGFzcyB0cmFuc2FjdGlvbl9ndWFyZAp7CiAgYm9vbCBj
b21taXR0ZWQ7CiAgZGF0YWJhc2UgJiBkYjsKcHVibGljOgogIHRyYW5zYWN0aW9uX2d1YXJkKGRh
dGFiYXNlICYgZCk7CiAgfnRyYW5zYWN0aW9uX2d1YXJkKCk7CiAgdm9pZCBjb21taXQoKTsKfTsK
CgoKI2VuZGlmIC8vIF9fREFUQUJBU0VfSEhfXwo=
])

AT_DATA(right.b64, [
I2lmbmRlZiBfX0RBVEFCQVNFX0hIX18KI2RlZmluZSBfX0RBVEFCQVNFX0hIX18KCi8vIGNvcHly
aWdodCAoQykgMjAwMiwgMjAwMyBncmF5ZG9uIGhvYXJlIDxncmF5ZG9uQHBvYm94LmNvbT4KLy8g
YWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gbGljZW5zZWQgdG8gdGhlIHB1YmxpYyB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBHUEwgKD49IDIpCi8vIHNlZSB0aGUgZmlsZSBDT1BZSU5HIGZvciBk
ZXRhaWxzCgpzdHJ1Y3Qgc3FsaXRlMzsKc3RydWN0IGNlcnQ7CgojaW5jbHVkZSA8dmVjdG9yPgoj
aW5jbHVkZSA8c2V0PgojaW5jbHVkZSA8c3RyaW5nPgoKI2luY2x1ZGUgPGJvb3N0L2ZpbGVzeXN0
ZW0vcGF0aC5ocHA+CgojaW5jbHVkZSAiY29tbWFuZHMuaGgiCiNpbmNsdWRlICJtYW5pZmVzdC5o
aCIKI2luY2x1ZGUgIm51bWVyaWNfdm9jYWIuaGgiCiNpbmNsdWRlICJ2b2NhYi5oaCIKCnN0cnVj
dCByZXZpc2lvbl9zZXQ7CgovLyB0aGlzIGZpbGUgZGVmaW5lcyBhIHB1YmxpYywgdHlwZWQgaW50
ZXJmYWNlIHRvIHRoZSBkYXRhYmFzZS4KLy8gdGhlIGRhdGFiYXNlIGNsYXNzIGVuY2Fwc3VsYXRl
cyBhbGwga25vd2xlZGdlIGFib3V0IHNxbGl0ZSwKLy8gdGhlIHNjaGVtYSwgYW5kIGFsbCBTUUwg
c3RhdGVtZW50cyB1c2VkIHRvIGFjY2VzcyB0aGUgc2NoZW1hLgovLwovLyBvbmUgdGhpbmcgd2hp
Y2ggaXMgcmF0aGVyIGltcG9ydGFudCB0byBub3RlIGlzIHRoYXQgdGhpcyBmaWxlCi8vIGRlYWxz
IHdpdGggdHdvIHNvcnRzIG9mIHZlcnNpb24gcmVsYXRpb25zaGlwcy4gdGhlIHZlcnNpb25zCi8v
IHN0b3JlZCBpbiB0aGUgZGF0YWJhc2UgYXJlIGFsbCAqYmFja3dhcmRzKiBmcm9tIHRob3NlIHRo
ZSBwcm9ncmFtCi8vIHNlZXMuIHNvIGZvciBleGFtcGxlIGlmIHlvdSBoYXZlIHR3byB2ZXJzaW9u
cyBvZiBhIGZpbGUKLy8gCi8vIGZpbGUuMSwgZmlsZS4yCi8vCi8vIHdoZXJlIGZpbGUuMiB3YXMg
YSBtb2RpZmljYXRpb24gb2YgZmlsZS4xLCB0aGVuIGFzIGZhciBhcyB0aGUgcmVzdCBvZgovLyB0
aGUgYXBwbGljYXRpb24gaXMgY29uY2VybmVkIC0tIGFuZCB0aGUgYW5jZXN0cnkgZ3JhcGggLS0g
ZmlsZS4xIGlzIHRoZQovLyAib2xkIiB2ZXJzaW9uIGFuZCBmaWxlLjIgaXMgdGhlICJuZXciIHZl
cnNpb24uIG5vdGUgdGhlIHVzZSBvZiB0ZXJtcwovLyB3aGljaCBkZXNjcmliZSB0aW1lLCBhbmQg
dGhlIHNlcXVlbmNlIG9mIGVkaXRzIGEgdXNlciBtYWtlcyB0byBhCi8vIGZpbGUuIHRob3NlIGFy
ZSBhbmNlc3RyeSB0ZXJtcy4gd2hlbiB0aGUgYXBwbGljYXRpb24gY29tcG9zZXMgYQovLyBwYXRj
aHNldCwgZm9yIGV4YW1wbGUsIGl0J2xsIGNvbnRhaW4gdGhlIGRpZmYgZGVsdGEoZmlsZS4xLCBm
aWxlLjIpCi8vCi8vIGZyb20gdGhlIGRhdGFiYXNlJ3MgcGVyc3BlY3RpdmUsIGhvd2V2ZXIsIGZp
bGUuMSBpcyB0aGUgZGVyaXZlZCB2ZXJzaW9uLAovLyBhbmQgZmlsZS4yIGlzIHRoZSBiYXNlIHZl
cnNpb24uIHRoZSBiYXNlIHZlcnNpb24gaXMgc3RvcmVkIGluIHRoZQovLyAiZmlsZXMiIHRhYmxl
LCBhbmQgdGhlICpyZXZlcnNlKiBkaWZmIGRlbHRhKGZpbGUuMiwgZmlsZS4xKSBpcyBzdG9yZWQg
aW4KLy8gdGhlICJmaWxlX2RlbHRhcyIgdGFibGUsIHVuZGVyIHRoZSBpZCBvZiBmaWxlLjEsIHdp
dGggdGhlIGlkIG9mIGZpbGUuMgovLyBsaXN0ZWQgYXMgaXRzIGJhc2UuIG5vdGUgdGhlIHVzZSBv
ZiB0aGUgdGVybXMgd2hpY2ggZGVzY3JpYmUKLy8gcmVjb25zdHJ1Y3Rpb247IHRob3NlIGFyZSBz
dG9yYWdlLXN5c3RlbSB0ZXJtcy4KLy8KLy8gdGhlIGludGVyZmFjZSAqdG8qIHRoZSBkYXRhYmFz
ZSwgYW5kIHRoZSBhbmNlc3RyeSB2ZXJzaW9uIGdyYXBocywgdXNlCi8vIHRoZSBvbGQgLyBuZXcg
bWV0YXBob3Igb2YgYW5jZXN0cnksIGJ1dCB3aXRoaW4gdGhlIGRhdGFiYXNlIChpbmNsdWRpbmcK
Ly8gdGhlIHByaXZhdGUgaGVscGVyIG1ldGhvZHMsIGFuZCB0aGUgc3RvcmFnZSB2ZXJzaW9uIGdy
YXBocykgdGhlCi8vIGJhc2UvZGVyaXZlZCBzdG9yYWdlIG1ldGFwaG9yIGlzIHVzZWQuIHRoZSBv
bmx5IHJlYWwgd2F5IHRvIHRlbGwgd2hpY2gKLy8gaXMgd2hpY2ggaXMgdG8gbG9vayBhdCB0aGUg
cGFyYW1ldGVyIG5hbWVzIGFuZCBjb2RlLiBJIG1pZ2h0IHRyeSB0bwovLyBleHByZXNzIHRoaXMg
aW4gdGhlIHR5cGUgc3lzdGVtIHNvbWUgZGF5LCBidXQgbm90IHByZXNlbnRseS4KLy8KLy8gdGhl
IGtleSBwaHJhc2UgdG8ga2VlcCByZXBlYXRpbmcgd2hlbiB3b3JraW5nIG9uIHRoaXMgY29kZSBp
czoKLy8gCi8vICJiYXNlIGZpbGVzIGFyZSBuZXcsIGRlcml2ZWQgZmlsZXMgYXJlIG9sZCIKLy8K
Ly8gaXQgbWFrZXMgdGhlIGNvZGUgY29uZnVzaW5nLCBJIGtub3cuIHRoaXMgaXMgcG9zc2libHkg
dGhlIHdvcnN0IHBhcnQgb2YKLy8gdGhlIHByb2dyYW0uIEkgZG9uJ3Qga25vdyBpZiB0aGVyZSdz
IGFueSB3YXkgdG8gbWFrZSBpdCBjbGVhcmVyLgoKY2xhc3MgdHJhbnNhY3Rpb25fZ3VhcmQ7CnN0
cnVjdCBwb3N0aW5nOwpzdHJ1Y3QgYXBwX3N0YXRlOwoKY2xhc3MgZGF0YWJhc2UKewogIGZzOjpw
YXRoIGZpbGVuYW1lOwogIHN0ZDo6c3RyaW5nIGNvbnN0IHNjaGVtYTsKICB2b2lkIGNoZWNrX3Nj
aGVtYSgpOwoKICBzdHJ1Y3QgYXBwX3N0YXRlICogX19hcHA7CiAgc3RydWN0IHNxbGl0ZTMgKiBf
X3NxbDsKICBzdHJ1Y3Qgc3FsaXRlMyAqIHNxbChib29sIGluaXQgPSBmYWxzZSk7CiAgaW50IHRy
YW5zYWN0aW9uX2xldmVsOwoKICB2b2lkIGluc3RhbGxfZnVuY3Rpb25zKGFwcF9zdGF0ZSAqIGFw
cCk7CiAgdm9pZCBpbnN0YWxsX3ZpZXdzKCk7CgogIHR5cGVkZWYgc3RkOjp2ZWN0b3I8IHN0ZDo6
dmVjdG9yPHN0ZDo6c3RyaW5nPiA+IHJlc3VsdHM7CiAgdm9pZCBleGVjdXRlKGNoYXIgY29uc3Qg
KiBxdWVyeSwgLi4uKTsKICB2b2lkIGZldGNoKHJlc3VsdHMgJiByZXMsIAogICAgICAgICAgICAg
aW50IGNvbnN0IHdhbnRfY29scywgCiAgICAgICAgICAgICBpbnQgY29uc3Qgd2FudF9yb3dzLCAK
ICAgICAgICAgICAgIGNoYXIgY29uc3QgKiBxdWVyeSwgLi4uKTsKCiAgYm9vbCBleGlzdHMoaGV4
ZW5jPGlkPiBjb25zdCAmIGlkZW50LCAKICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAm
IHRhYmxlKTsKICBib29sIGRlbHRhX2V4aXN0cyhoZXhlbmM8aWQ+IGNvbnN0ICYgaWRlbnQsCiAg
ICAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7CiAgYm9vbCBkZWx0
YV9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkZW50LAogICAgICAgICAgICAgICAgICAgIGhl
eGVuYzxpZD4gY29uc3QgJiBiYXNlLAogICAgICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNv
bnN0ICYgdGFibGUpOwoKICBpbnQgY291bnQoc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7Cgog
IHZvaWQgZ2V0X2lkcyhzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxlLCBzdGQ6OnNldDwgaGV4ZW5j
PGlkPiA+ICYgaWRzKTsgCgogIHZvaWQgZ2V0KGhleGVuYzxpZD4gY29uc3QgJiBuZXdfaWQsCiAg
ICAgICAgICAgYmFzZTY0PCBnemlwPGRhdGE+ID4gJiBkYXQsCiAgICAgICAgICAgc3RkOjpzdHJp
bmcgY29uc3QgJiB0YWJsZSk7CiAgdm9pZCBnZXRfZGVsdGEoaGV4ZW5jPGlkPiBjb25zdCAmIGlk
ZW50LAogICAgICAgICAgICAgICAgIGhleGVuYzxpZD4gY29uc3QgJiBiYXNlLAogICAgICAgICAg
ICAgICAgIGJhc2U2NDwgZ3ppcDxkZWx0YT4gPiAmIGRlbCwKICAgICAgICAgICAgICAgICBzdGQ6
OnN0cmluZyBjb25zdCAmIHRhYmxlKTsKICB2b2lkIGdldF92ZXJzaW9uKGhleGVuYzxpZD4gY29u
c3QgJiBpZCwKICAgICAgICAgICAgICAgICAgIGJhc2U2NDwgZ3ppcDxkYXRhPiA+ICYgZGF0LAog
ICAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiBkYXRhX3RhYmxlLAogICAgICAg
ICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiBkZWx0YV90YWJsZSk7CiAgCiAgdm9pZCBw
dXQoaGV4ZW5jPGlkPiBjb25zdCAmIG5ld19pZCwKICAgICAgICAgICBiYXNlNjQ8IGd6aXA8ZGF0
YT4gPiBjb25zdCAmIGRhdCwKICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxlKTsK
ICB2b2lkIGRyb3AoaGV4ZW5jPGlkPiBjb25zdCAmIGJhc2UsCiAgICAgICAgICAgIHN0ZDo6c3Ry
aW5nIGNvbnN0ICYgdGFibGUpOwogIHZvaWQgcHV0X2RlbHRhKGhleGVuYzxpZD4gY29uc3QgJiBp
ZCwKICAgICAgICAgICAgICAgICBoZXhlbmM8aWQ+IGNvbnN0ICYgYmFzZSwKICAgICAgICAgICAg
ICAgICBiYXNlNjQ8IGd6aXA8ZGVsdGE+ID4gY29uc3QgJiBkZWwsCiAgICAgICAgICAgICAgICAg
c3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7CiAgdm9pZCBwdXRfdmVyc2lvbihoZXhlbmM8aWQ+
IGNvbnN0ICYgb2xkX2lkLAogICAgICAgICAgICAgICAgICAgaGV4ZW5jPGlkPiBjb25zdCAmIG5l
d19pZCwKICAgICAgICAgICAgICAgICAgIGJhc2U2NDwgZ3ppcDxkZWx0YT4gPiBjb25zdCAmIGRl
bCwKICAgICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgZGF0YV90YWJsZSwKICAg
ICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgZGVsdGFfdGFibGUpOwogIHZvaWQg
cHV0X3JldmVyc2VfdmVyc2lvbihoZXhlbmM8aWQ+IGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICBoZXhlbmM8aWQ+IGNvbnN0ICYgb2xkX2lkLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICBiYXNlNjQ8IGd6aXA8ZGVsdGE+ID4gY29uc3QgJiByZXZlcnNlX2RlbCwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiBkYXRhX3RhYmxl
LAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIGRlbHRhX3Rh
YmxlKTsKCiAgYm9vbCBjZXJ0X2V4aXN0cyhjZXJ0IGNvbnN0ICYgdCwKICAgICAgICAgICAgICAg
ICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7CiAgdm9pZCBwdXRfY2VydChjZXJ0IGNvbnN0
ICYgdCwgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7ICAKICB2b2lkIHJlc3VsdHNfdG9fY2Vy
dHMocmVzdWx0cyBjb25zdCAmIHJlcywKICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnZlY3Rv
cjxjZXJ0PiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRfY2VydHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlk
LCAKICAgICAgICAgICAgICAgIHN0ZDo6dmVjdG9yPCBjZXJ0ID4gJiBjZXJ0cywKICAgICAgICAg
ICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOyAgCgogIHZvaWQgZ2V0X2NlcnRzKGNl
cnRfbmFtZSBjb25zdCAmIG5hbWUsICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHN0ZDo6
dmVjdG9yPCBjZXJ0ID4gJiBjZXJ0cywKICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0
ICYgdGFibGUpOwoKICB2b2lkIGdldF9jZXJ0cyhoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsCiAgICAg
ICAgICAgICAgICBjZXJ0X25hbWUgY29uc3QgJiBuYW1lLAogICAgICAgICAgICAgICAgc3RkOjp2
ZWN0b3I8IGNlcnQgPiAmIGNlcnRzLAogICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3Qg
JiB0YWJsZSk7ICAKCiAgdm9pZCBnZXRfY2VydHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkLAogICAg
ICAgICAgICAgICAgY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwKICAgICAgICAgICAgICAgIGJhc2U2
NDxjZXJ0X3ZhbHVlPiBjb25zdCAmIHZhbCwgCiAgICAgICAgICAgICAgICBzdGQ6OnZlY3Rvcjwg
Y2VydCA+ICYgY2VydHMsCiAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxl
KTsgIAoKICB2b2lkIGdldF9jZXJ0cyhjZXJ0X25hbWUgY29uc3QgJiBuYW1lLAogICAgICAgICAg
ICAgICAgYmFzZTY0PGNlcnRfdmFsdWU+IGNvbnN0ICYgdmFsLCAKICAgICAgICAgICAgICAgIHN0
ZDo6dmVjdG9yPGNlcnQ+ICYgY2VydHMsCiAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25z
dCAmIHRhYmxlKTsKCiAgdm9pZCBiZWdpbl90cmFuc2FjdGlvbigpOwogIHZvaWQgY29tbWl0X3Ry
YW5zYWN0aW9uKCk7CiAgdm9pZCByb2xsYmFja190cmFuc2FjdGlvbigpOwogIGZyaWVuZCBjbGFz
cyB0cmFuc2FjdGlvbl9ndWFyZDsKICBmcmllbmQgdm9pZCByY3NfcHV0X3Jhd19maWxlX2VkZ2Uo
aGV4ZW5jPGlkPiBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaGV4ZW5jPGlkPiBjb25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYmFzZTY0PCBnemlwPGRlbHRhPiA+IGNvbnN0ICYgZGVsLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZSAmIGRiKTsKICBmcmllbmQgdm9pZCBy
Y3NfcHV0X3Jhd19tYW5pZmVzdF9lZGdlKGhleGVuYzxpZD4gY29uc3QgJiBvbGRfaWQsCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXhlbmM8aWQ+IGNvbnN0ICYgbmV3
X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTY0PCBnemlw
PGRlbHRhPiA+IGNvbnN0ICYgZGVsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZGF0YWJhc2UgJiBkYik7CgpwdWJsaWM6CgogIGRhdGFiYXNlKGZzOjpwYXRoIGNvbnN0
ICYgZmlsZSk7CgogIHVuc2lnbmVkIGxvbmcgZ2V0X3N0YXRpc3RpYyhzdGQ6OnN0cmluZyBjb25z
dCAmIHF1ZXJ5KTsKICB2b2lkIHNldF9maWxlbmFtZShmczo6cGF0aCBjb25zdCAmIGZpbGUpOwog
IHZvaWQgaW5pdGlhbGl6ZSgpOwogIHZvaWQgZGVidWcoc3RkOjpzdHJpbmcgY29uc3QgJiBzcWws
IHN0ZDo6b3N0cmVhbSAmIG91dCk7CiAgdm9pZCBkdW1wKHN0ZDo6b3N0cmVhbSAmKTsKICB2b2lk
IGxvYWQoc3RkOjppc3RyZWFtICYpOwogIHZvaWQgaW5mbyhzdGQ6Om9zdHJlYW0gJik7CiAgdm9p
ZCB2ZXJzaW9uKHN0ZDo6b3N0cmVhbSAmKTsKICB2b2lkIG1pZ3JhdGUoKTsKICB2b2lkIHJlaGFz
aCgpOwogIHZvaWQgZW5zdXJlX29wZW4oKTsKICAKICBib29sIGZpbGVfdmVyc2lvbl9leGlzdHMo
ZmlsZV9pZCBjb25zdCAmIGlkKTsKICBib29sIG1hbmlmZXN0X3ZlcnNpb25fZXhpc3RzKG1hbmlm
ZXN0X2lkIGNvbnN0ICYgaWQpOwogIGJvb2wgcmV2aXNpb25fZXhpc3RzKHJldmlzaW9uX2lkIGNv
bnN0ICYgaWQpOwoKICB2b2lkIGdldF9maWxlX2lkcyhzdGQ6OnNldDxmaWxlX2lkPiAmIGlkcyk7
CiAgdm9pZCBnZXRfbWFuaWZlc3RfaWRzKHN0ZDo6c2V0PG1hbmlmZXN0X2lkPiAmIGlkcyk7CiAg
dm9pZCBnZXRfcmV2aXNpb25faWRzKHN0ZDo6c2V0PHJldmlzaW9uX2lkPiAmIGlkcyk7CgogIHZv
aWQgc2V0X2FwcChhcHBfc3RhdGUgKiBhcHApOwogIAogIC8vIGdldCBwbGFpbiB2ZXJzaW9uIGlm
IGl0IGV4aXN0cywgb3IgcmVjb25zdHJ1Y3QgdmVyc2lvbgogIC8vIGZyb20gZGVsdGFzIChpZiB0
aGV5IGV4aXN0KQogIHZvaWQgZ2V0X2ZpbGVfdmVyc2lvbihmaWxlX2lkIGNvbnN0ICYgaWQsCiAg
ICAgICAgICAgICAgICAgICAgICAgIGZpbGVfZGF0YSAmIGRhdCk7CgogIC8vIGdldCBmaWxlIGRl
bHRhIGlmIGl0IGV4aXN0cywgZWxzZSBjYWxjdWxhdGUgaXQuCiAgLy8gYm90aCBtYW5pZmVzdHMg
bXVzdCBleGlzdC4KICB2b2lkIGdldF9maWxlX2RlbHRhKGZpbGVfaWQgY29uc3QgJiBzcmMsCiAg
ICAgICAgICAgICAgICAgICAgICBmaWxlX2lkIGNvbnN0ICYgZHN0LAogICAgICAgICAgICAgICAg
ICAgICAgZmlsZV9kZWx0YSAmIGRlbCk7CgogIC8vIHB1dCBmaWxlIHcvbyBwcmVkZWNlc3NvciBp
bnRvIGRiCiAgdm9pZCBwdXRfZmlsZShmaWxlX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAg
ICAgICAgZmlsZV9kYXRhIGNvbnN0ICYgZGF0KTsKCiAgLy8gc3RvcmUgbmV3IHZlcnNpb24gYW5k
IHVwZGF0ZSBvbGQgdmVyc2lvbiB0byBiZSBhIGRlbHRhCiAgdm9pZCBwdXRfZmlsZV92ZXJzaW9u
KGZpbGVfaWQgY29uc3QgJiBvbGRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfaWQg
Y29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfZGVsdGEgY29uc3Qg
JiBkZWwpOwoKICAvLyBsb2FkIGluIGEgImRpcmVjdCIgbmV3IC0+IG9sZCByZXZlcnNlIGVkZ2Ug
KHVzZWQgZHVyaW5nCiAgLy8gbmV0c3luYyBhbmQgQ1ZTIGxvYWQtaW4pCiAgdm9pZCBwdXRfZmls
ZV9yZXZlcnNlX3ZlcnNpb24oZmlsZV9pZCBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBmaWxlX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGZpbGVfZGVsdGEgY29uc3QgJiBkZWwpOwoKICAvLyBnZXQgcGxhaW4g
dmVyc2lvbiBpZiBpdCBleGlzdHMsIG9yIHJlY29uc3RydWN0IHZlcnNpb24KICAvLyBmcm9tIGRl
bHRhcyAoaWYgdGhleSBleGlzdCkuIAogIHZvaWQgZ2V0X21hbmlmZXN0X3ZlcnNpb24obWFuaWZl
c3RfaWQgY29uc3QgJiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2Rh
dGEgJiBkYXQpOwoKICAvLyBnZXQgYSBjb25zdHJ1Y3RlZCBtYW5pZmVzdAogIHZvaWQgZ2V0X21h
bmlmZXN0KG1hbmlmZXN0X2lkIGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgICAgbWFuaWZl
c3RfbWFwICYgbW0pOwoKICAvLyBnZXQgbWFuaWZlc3QgZGVsdGEgaWYgaXQgZXhpc3RzLCBlbHNl
IGNhbGN1bGF0ZSBpdC4KICAvLyBib3RoIG1hbmlmZXN0cyBtdXN0IGV4aXN0LgogIHZvaWQgZ2V0
X21hbmlmZXN0X2RlbHRhKG1hbmlmZXN0X2lkIGNvbnN0ICYgc3JjLAogICAgICAgICAgICAgICAg
ICAgICAgICAgIG1hbmlmZXN0X2lkIGNvbnN0ICYgZHN0LAogICAgICAgICAgICAgICAgICAgICAg
ICAgIG1hbmlmZXN0X2RlbHRhICYgZGVsKTsKCiAgLy8gcHV0IG1hbmlmZXN0IHcvbyBwcmVkZWNl
c3NvciBpbnRvIGRiCiAgdm9pZCBwdXRfbWFuaWZlc3QobWFuaWZlc3RfaWQgY29uc3QgJiBuZXdf
aWQsCiAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3RfZGF0YSBjb25zdCAmIGRhdCk7CgogIC8v
IHN0b3JlIG5ldyB2ZXJzaW9uIGFuZCB1cGRhdGUgb2xkIHZlcnNpb24gdG8gYmUgYSBkZWx0YQog
IHZvaWQgcHV0X21hbmlmZXN0X3ZlcnNpb24obWFuaWZlc3RfaWQgY29uc3QgJiBvbGRfaWQsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdF9pZCBjb25zdCAmIG5ld19pZCwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2RlbHRhIGNvbnN0ICYgZGVsKTsKCiAg
Ly8gbG9hZCBpbiBhICJkaXJlY3QiIG5ldyAtPiBvbGQgcmV2ZXJzZSBlZGdlICh1c2VkIGR1cmlu
ZwogIC8vIG5ldHN5bmMgYW5kIENWUyBsb2FkLWluKQogIHZvaWQgcHV0X21hbmlmZXN0X3JldmVy
c2VfdmVyc2lvbihtYW5pZmVzdF9pZCBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbWFuaWZlc3RfaWQgY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2RlbHRhIGNvbnN0ICYgZGVsKTsKCgog
IHZvaWQgZ2V0X3JldmlzaW9uX2FuY2VzdHJ5KHN0ZDo6bXVsdGltYXA8cmV2aXNpb25faWQsIHJl
dmlzaW9uX2lkPiAmIGdyYXBoKTsKCiAgdm9pZCBnZXRfcmV2aXNpb25fcGFyZW50cyhyZXZpc2lv
bl9pZCBjb25zdCAmIGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnNldDxyZXZp
c2lvbl9pZD4gJiBwYXJlbnRzKTsKCiAgdm9pZCBnZXRfcmV2aXNpb25fY2hpbGRyZW4ocmV2aXNp
b25faWQgY29uc3QgJiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnNldDxy
ZXZpc2lvbl9pZD4gJiBjaGlsZHJlbik7CgogIHZvaWQgZ2V0X3JldmlzaW9uX21hbmlmZXN0KHJl
dmlzaW9uX2lkIGNvbnN0ICYgY2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZl
c3RfaWQgJiBtaWQpOwoKICB2b2lkIGdldF9yZXZpc2lvbihyZXZpc2lvbl9pZCBjb25zdCAmIGlk
LAogICAgICAgICAgICAgICAgICAgcmV2aXNpb25fc2V0ICYgY3MpOwoKICB2b2lkIGdldF9yZXZp
c2lvbihyZXZpc2lvbl9pZCBjb25zdCAmIGlkLAogICAgICAgICAgICAgICAgICAgcmV2aXNpb25f
ZGF0YSAmIGRhdCk7CgogIHZvaWQgcHV0X3JldmlzaW9uKHJldmlzaW9uX2lkIGNvbnN0ICYgbmV3
X2lkLAogICAgICAgICAgICAgICAgICAgcmV2aXNpb25fc2V0IGNvbnN0ICYgY3MpOwoKICB2b2lk
IHB1dF9yZXZpc2lvbihyZXZpc2lvbl9pZCBjb25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAg
ICAgICByZXZpc2lvbl9kYXRhIGNvbnN0ICYgZGF0KTsKICAKICB2b2lkIGRlbGV0ZV9leGlzdGlu
Z19yZXZzX2FuZF9jZXJ0cygpOwoKICAvLyBjcnlwdG8ga2V5IC8gY2VydCBvcGVyYXRpb25zCgog
IHZvaWQgZ2V0X2tleV9pZHMoc3RkOjpzdHJpbmcgY29uc3QgJiBwYXR0ZXJuLAogICAgICAgICAg
ICAgICAgICAgc3RkOjp2ZWN0b3I8cnNhX2tleXBhaXJfaWQ+ICYgcHVia2V5cywKICAgICAgICAg
ICAgICAgICAgIHN0ZDo6dmVjdG9yPHJzYV9rZXlwYWlyX2lkPiAmIHByaXZrZXlzKTsKCiAgdm9p
ZCBnZXRfcHJpdmF0ZV9rZXlzKHN0ZDo6dmVjdG9yPHJzYV9rZXlwYWlyX2lkPiAmIHByaXZrZXlz
KTsKCiAgYm9vbCBrZXlfZXhpc3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwoKICBib29s
IHB1YmxpY19rZXlfZXhpc3RzKGhleGVuYzxpZD4gY29uc3QgJiBoYXNoKTsKICBib29sIHB1Ymxp
Y19rZXlfZXhpc3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwogIGJvb2wgcHJpdmF0ZV9r
ZXlfZXhpc3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwogIAogIHZvaWQgZ2V0X3B1Ymtl
eShoZXhlbmM8aWQ+IGNvbnN0ICYgaGFzaCwgCiAgICAgICAgICAgICAgICAgIHJzYV9rZXlwYWly
X2lkICYgaWQsCiAgICAgICAgICAgICAgICAgIGJhc2U2NDxyc2FfcHViX2tleT4gJiBwdWJfZW5j
b2RlZCk7CgogIHZvaWQgZ2V0X2tleShyc2Ffa2V5cGFpcl9pZCBjb25zdCAmIGlkLCAKICAgICAg
ICAgICAgICAgYmFzZTY0PHJzYV9wdWJfa2V5PiAmIHB1Yl9lbmNvZGVkKTsKCiAgdm9pZCBnZXRf
a2V5KHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICBiYXNlNjQ8IGFy
YzQ8cnNhX3ByaXZfa2V5PiA+ICYgcHJpdl9lbmNvZGVkKTsKCiAgdm9pZCBwdXRfa2V5KHJzYV9r
ZXlwYWlyX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICBiYXNlNjQ8cnNhX3B1Yl9rZXk+
IGNvbnN0ICYgcHViX2VuY29kZWQpOwogIAogIHZvaWQgcHV0X2tleShyc2Ffa2V5cGFpcl9pZCBj
b25zdCAmIGlkLCAKICAgICAgICAgICAgICAgYmFzZTY0PCBhcmM0PHJzYV9wcml2X2tleT4gPiBj
b25zdCAmIHByaXZfZW5jb2RlZCk7CiAgCiAgdm9pZCBwdXRfa2V5X3BhaXIocnNhX2tleXBhaXJf
aWQgY29uc3QgJiBwdWJfaWQsIAogICAgICAgICAgICAgICAgICAgIGJhc2U2NDxyc2FfcHViX2tl
eT4gY29uc3QgJiBwdWJfZW5jb2RlZCwKICAgICAgICAgICAgICAgICAgICBiYXNlNjQ8IGFyYzQ8
cnNhX3ByaXZfa2V5PiA+IGNvbnN0ICYgcHJpdl9lbmNvZGVkKTsKCiAgdm9pZCBkZWxldGVfcHJp
dmF0ZV9rZXkocnNhX2tleXBhaXJfaWQgY29uc3QgJiBwdWJfaWQpOwoKICAvLyBub3RlOiB0aGlz
IHNlY3Rpb24gaXMgcmlkaWN1bG91cy4gcGxlYXNlIGRvIHNvbWV0aGluZyBhYm91dCBpdC4KCiAg
Ym9vbCBtYW5pZmVzdF9jZXJ0X2V4aXN0cyhtYW5pZmVzdDxjZXJ0PiBjb25zdCAmIGNlcnQpOwog
IGJvb2wgbWFuaWZlc3RfY2VydF9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gpOwogIHZv
aWQgcHV0X21hbmlmZXN0X2NlcnQobWFuaWZlc3Q8Y2VydD4gY29uc3QgJiBjZXJ0KTsKCiAgYm9v
bCByZXZpc2lvbl9jZXJ0X2V4aXN0cyhyZXZpc2lvbjxjZXJ0PiBjb25zdCAmIGNlcnQpOwogIGJv
b2wgcmV2aXNpb25fY2VydF9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gpOwoKICB2b2lk
IHB1dF9yZXZpc2lvbl9jZXJ0KHJldmlzaW9uPGNlcnQ+IGNvbnN0ICYgY2VydCk7CgogIC8vIHRo
aXMgdmFyaWFudCBoYXMgdG8gYmUgcmF0aGVyIGNvYXJzZSBhbmQgZmFzdCwgZm9yIG5ldHN5bmMn
cyB1c2UKICB2b2lkIGdldF9yZXZpc2lvbl9jZXJ0X2luZGV4KHN0ZDo6dmVjdG9yPCBzdGQ6OnBh
aXI8aGV4ZW5jPGlkPiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6cGFpcjxy
ZXZpc2lvbl9pZCwgcnNhX2tleXBhaXJfaWQ+ID4gPiAmIGlkeCk7CgogIHZvaWQgZ2V0X3Jldmlz
aW9uX2NlcnRzKGNlcnRfbmFtZSBjb25zdCAmIG5hbWUsIAogICAgICAgICAgICAgICAgICAgICAg
ICAgc3RkOjp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQgZ2V0X3Jl
dmlzaW9uX2NlcnRzKHJldmlzaW9uX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICAgICAg
ICAgICAgY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAgICAgICBz
dGQ6OnZlY3RvcjwgcmV2aXNpb248Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRfcmV2aXNp
b25fY2VydHMoY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAg
IGJhc2U2NDxjZXJ0X3ZhbHVlPiBjb25zdCAmIHZhbCwgCiAgICAgICAgICAgICAgICAgICAgICAg
ICBzdGQ6OnZlY3RvcjwgcmV2aXNpb248Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRfcmV2
aXNpb25fY2VydHMocmV2aXNpb25faWQgY29uc3QgJiBpZCwgCiAgICAgICAgICAgICAgICAgICAg
ICAgICBjZXJ0X25hbWUgY29uc3QgJiBuYW1lLCAKICAgICAgICAgICAgICAgICAgICAgICAgIGJh
c2U2NDxjZXJ0X3ZhbHVlPiBjb25zdCAmIHZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAg
c3RkOjp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQgZ2V0X3Jldmlz
aW9uX2NlcnRzKHJldmlzaW9uX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICAgICAgICAg
ICAgc3RkOjp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQgZ2V0X3Jl
dmlzaW9uX2NlcnQoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gsCiAgICAgICAgICAgICAgICAgICAg
ICAgICByZXZpc2lvbjxjZXJ0PiAmIGNlcnQpOwogIAogIHZvaWQgZ2V0X21hbmlmZXN0X2NlcnRz
KG1hbmlmZXN0X2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6
dmVjdG9yPCBtYW5pZmVzdDxjZXJ0PiA+ICYgY2VydHMpOwoKICB2b2lkIGdldF9tYW5pZmVzdF9j
ZXJ0cyhjZXJ0X25hbWUgY29uc3QgJiBuYW1lLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBz
dGQ6OnZlY3RvcjwgbWFuaWZlc3Q8Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRfbWFuaWZl
c3RfY2VydHMobWFuaWZlc3RfaWQgY29uc3QgJiBpZCwgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3Rk
Ojp2ZWN0b3I8IG1hbmlmZXN0PGNlcnQ+ID4gJiBjZXJ0cyk7CiAgCiAgdm9pZCBnZXRfbWFuaWZl
c3RfY2VydChoZXhlbmM8aWQ+IGNvbnN0ICYgaGFzaCwKICAgICAgICAgICAgICAgICAgICAgICAg
IG1hbmlmZXN0PGNlcnQ+ICYgY2VydCk7CgogIAogIC8vIG1lcmtsZSB0cmVlIHN0dWZmCgogIGJv
b2wgbWVya2xlX25vZGVfZXhpc3RzKHN0ZDo6c3RyaW5nIGNvbnN0ICYgdHlwZSwKICAgICAgICAg
ICAgICAgICAgICAgICAgICB1dGY4IGNvbnN0ICYgY29sbGVjdGlvbiwgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgc2l6ZV90IGxldmVsLAogICAgICAgICAgICAgICAgICAgICAgICAgIGhleGVu
YzxwcmVmaXg+IGNvbnN0ICYgcHJlZml4KTsKICAKICB2b2lkIGdldF9tZXJrbGVfbm9kZShzdGQ6
OnN0cmluZyBjb25zdCAmIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgdXRmOCBjb25zdCAm
IGNvbGxlY3Rpb24sIAogICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCBsZXZlbCwKICAgICAg
ICAgICAgICAgICAgICAgICBoZXhlbmM8cHJlZml4PiBjb25zdCAmIHByZWZpeCwKICAgICAgICAg
ICAgICAgICAgICAgICBiYXNlNjQ8bWVya2xlPiAmIG5vZGUpOwoKICB2b2lkIHB1dF9tZXJrbGVf
bm9kZShzdGQ6OnN0cmluZyBjb25zdCAmIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgdXRm
OCBjb25zdCAmIGNvbGxlY3Rpb24sIAogICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCBsZXZl
bCwKICAgICAgICAgICAgICAgICAgICAgICBoZXhlbmM8cHJlZml4PiBjb25zdCAmIHByZWZpeCwK
ICAgICAgICAgICAgICAgICAgICAgICBiYXNlNjQ8bWVya2xlPiBjb25zdCAmIG5vZGUpOwoKICB2
b2lkIGVyYXNlX21lcmtsZV9ub2RlcyhzdGQ6OnN0cmluZyBjb25zdCAmIHR5cGUsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgdXRmOCBjb25zdCAmIGNvbGxlY3Rpb24pOwoKICAvLyBjb21wbGV0
aW9uIHN0dWZmCgogIHZvaWQgY29tcGxldGUoc3RkOjpzdHJpbmcgY29uc3QgJiBwYXJ0aWFsLAog
ICAgICAgICAgICAgICAgc3RkOjpzZXQ8cmV2aXNpb25faWQ+ICYgY29tcGxldGlvbnMpOwoKICB2
b2lkIGNvbXBsZXRlKHN0ZDo6c3RyaW5nIGNvbnN0ICYgcGFydGlhbCwKICAgICAgICAgICAgICAg
IHN0ZDo6c2V0PG1hbmlmZXN0X2lkPiAmIGNvbXBsZXRpb25zKTsKICAKICB2b2lkIGNvbXBsZXRl
KHN0ZDo6c3RyaW5nIGNvbnN0ICYgcGFydGlhbCwKICAgICAgICAgICAgICAgIHN0ZDo6c2V0PGZp
bGVfaWQ+ICYgY29tcGxldGlvbnMpOwoKICB2b2lkIGNvbXBsZXRlKGNvbW1hbmRzOjpzZWxlY3Rv
cl90eXBlIHR5LAogICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiBwYXJ0aWFsLAog
ICAgICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjpwYWlyPGNvbW1hbmRzOjpzZWxlY3Rvcl90
eXBlLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZz4g
PiBjb25zdCAmIGxpbWl0LAogICAgICAgICAgICAgICAgc3RkOjpzZXQ8c3RkOjpzdHJpbmc+ICYg
Y29tcGxldGlvbnMpOwogIAogIH5kYXRhYmFzZSgpOwoKfTsKCi8vIHRyYW5zYWN0aW9uIGd1YXJk
cyBuZXN0LiBhY3F1aXJlIG9uZSBpbiBhbnkgc2NvcGUgeW91J2QgbGlrZQovLyB0cmFuc2FjdGlv
bi1wcm90ZWN0ZWQsIGFuZCBpdCdsbCBtYWtlIHN1cmUgdGhlIGRiIGFib3J0cyBhCi8vIHR4biBp
ZiB0aGVyZSdzIGFueSBleGNlcHRpb24gYmVmb3JlIHlvdSBjYWxsIGNvbW1pdCgpCgpjbGFzcyB0
cmFuc2FjdGlvbl9ndWFyZAp7CiAgYm9vbCBjb21taXR0ZWQ7CiAgZGF0YWJhc2UgJiBkYjsKcHVi
bGljOgogIHRyYW5zYWN0aW9uX2d1YXJkKGRhdGFiYXNlICYgZCk7CiAgfnRyYW5zYWN0aW9uX2d1
YXJkKCk7CiAgdm9pZCBjb21taXQoKTsKfTsKCgoKI2VuZGlmIC8vIF9fREFUQUJBU0VfSEhfXwo=
])

AT_DATA(correct.b64, [
I2lmbmRlZiBfX0RBVEFCQVNFX0hIX18KI2RlZmluZSBfX0RBVEFCQVNFX0hIX18KCi8vIGNvcHly
aWdodCAoQykgMjAwMiwgMjAwMyBncmF5ZG9uIGhvYXJlIDxncmF5ZG9uQHBvYm94LmNvbT4KLy8g
YWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gbGljZW5zZWQgdG8gdGhlIHB1YmxpYyB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBHUEwgKD49IDIpCi8vIHNlZSB0aGUgZmlsZSBDT1BZSU5HIGZvciBk
ZXRhaWxzCgpzdHJ1Y3Qgc3FsaXRlMzsKc3RydWN0IGNlcnQ7CgojaW5jbHVkZSA8dmVjdG9yPgoj
aW5jbHVkZSA8c2V0PgojaW5jbHVkZSA8bWFwPgojaW5jbHVkZSA8c3RyaW5nPgoKI2luY2x1ZGUg
PGJvb3N0L2ZpbGVzeXN0ZW0vcGF0aC5ocHA+CgojaW5jbHVkZSAiY29tbWFuZHMuaGgiCiNpbmNs
dWRlICJtYW5pZmVzdC5oaCIKI2luY2x1ZGUgIm51bWVyaWNfdm9jYWIuaGgiCiNpbmNsdWRlICJ2
b2NhYi5oaCIKCnN0cnVjdCByZXZpc2lvbl9zZXQ7CgovLyB0aGlzIGZpbGUgZGVmaW5lcyBhIHB1
YmxpYywgdHlwZWQgaW50ZXJmYWNlIHRvIHRoZSBkYXRhYmFzZS4KLy8gdGhlIGRhdGFiYXNlIGNs
YXNzIGVuY2Fwc3VsYXRlcyBhbGwga25vd2xlZGdlIGFib3V0IHNxbGl0ZSwKLy8gdGhlIHNjaGVt
YSwgYW5kIGFsbCBTUUwgc3RhdGVtZW50cyB1c2VkIHRvIGFjY2VzcyB0aGUgc2NoZW1hLgovLwov
LyBvbmUgdGhpbmcgd2hpY2ggaXMgcmF0aGVyIGltcG9ydGFudCB0byBub3RlIGlzIHRoYXQgdGhp
cyBmaWxlCi8vIGRlYWxzIHdpdGggdHdvIHNvcnRzIG9mIHZlcnNpb24gcmVsYXRpb25zaGlwcy4g
dGhlIHZlcnNpb25zCi8vIHN0b3JlZCBpbiB0aGUgZGF0YWJhc2UgYXJlIGFsbCAqYmFja3dhcmRz
KiBmcm9tIHRob3NlIHRoZSBwcm9ncmFtCi8vIHNlZXMuIHNvIGZvciBleGFtcGxlIGlmIHlvdSBo
YXZlIHR3byB2ZXJzaW9ucyBvZiBhIGZpbGUKLy8gCi8vIGZpbGUuMSwgZmlsZS4yCi8vCi8vIHdo
ZXJlIGZpbGUuMiB3YXMgYSBtb2RpZmljYXRpb24gb2YgZmlsZS4xLCB0aGVuIGFzIGZhciBhcyB0
aGUgcmVzdCBvZgovLyB0aGUgYXBwbGljYXRpb24gaXMgY29uY2VybmVkIC0tIGFuZCB0aGUgYW5j
ZXN0cnkgZ3JhcGggLS0gZmlsZS4xIGlzIHRoZQovLyAib2xkIiB2ZXJzaW9uIGFuZCBmaWxlLjIg
aXMgdGhlICJuZXciIHZlcnNpb24uIG5vdGUgdGhlIHVzZSBvZiB0ZXJtcwovLyB3aGljaCBkZXNj
cmliZSB0aW1lLCBhbmQgdGhlIHNlcXVlbmNlIG9mIGVkaXRzIGEgdXNlciBtYWtlcyB0byBhCi8v
IGZpbGUuIHRob3NlIGFyZSBhbmNlc3RyeSB0ZXJtcy4gd2hlbiB0aGUgYXBwbGljYXRpb24gY29t
cG9zZXMgYQovLyBwYXRjaHNldCwgZm9yIGV4YW1wbGUsIGl0J2xsIGNvbnRhaW4gdGhlIGRpZmYg
ZGVsdGEoZmlsZS4xLCBmaWxlLjIpCi8vCi8vIGZyb20gdGhlIGRhdGFiYXNlJ3MgcGVyc3BlY3Rp
dmUsIGhvd2V2ZXIsIGZpbGUuMSBpcyB0aGUgZGVyaXZlZCB2ZXJzaW9uLAovLyBhbmQgZmlsZS4y
IGlzIHRoZSBiYXNlIHZlcnNpb24uIHRoZSBiYXNlIHZlcnNpb24gaXMgc3RvcmVkIGluIHRoZQov
LyAiZmlsZXMiIHRhYmxlLCBhbmQgdGhlICpyZXZlcnNlKiBkaWZmIGRlbHRhKGZpbGUuMiwgZmls
ZS4xKSBpcyBzdG9yZWQgaW4KLy8gdGhlICJmaWxlX2RlbHRhcyIgdGFibGUsIHVuZGVyIHRoZSBp
ZCBvZiBmaWxlLjEsIHdpdGggdGhlIGlkIG9mIGZpbGUuMgovLyBsaXN0ZWQgYXMgaXRzIGJhc2Uu
IG5vdGUgdGhlIHVzZSBvZiB0aGUgdGVybXMgd2hpY2ggZGVzY3JpYmUKLy8gcmVjb25zdHJ1Y3Rp
b247IHRob3NlIGFyZSBzdG9yYWdlLXN5c3RlbSB0ZXJtcy4KLy8KLy8gdGhlIGludGVyZmFjZSAq
dG8qIHRoZSBkYXRhYmFzZSwgYW5kIHRoZSBhbmNlc3RyeSB2ZXJzaW9uIGdyYXBocywgdXNlCi8v
IHRoZSBvbGQgLyBuZXcgbWV0YXBob3Igb2YgYW5jZXN0cnksIGJ1dCB3aXRoaW4gdGhlIGRhdGFi
YXNlIChpbmNsdWRpbmcKLy8gdGhlIHByaXZhdGUgaGVscGVyIG1ldGhvZHMsIGFuZCB0aGUgc3Rv
cmFnZSB2ZXJzaW9uIGdyYXBocykgdGhlCi8vIGJhc2UvZGVyaXZlZCBzdG9yYWdlIG1ldGFwaG9y
IGlzIHVzZWQuIHRoZSBvbmx5IHJlYWwgd2F5IHRvIHRlbGwgd2hpY2gKLy8gaXMgd2hpY2ggaXMg
dG8gbG9vayBhdCB0aGUgcGFyYW1ldGVyIG5hbWVzIGFuZCBjb2RlLiBJIG1pZ2h0IHRyeSB0bwov
LyBleHByZXNzIHRoaXMgaW4gdGhlIHR5cGUgc3lzdGVtIHNvbWUgZGF5LCBidXQgbm90IHByZXNl
bnRseS4KLy8KLy8gdGhlIGtleSBwaHJhc2UgdG8ga2VlcCByZXBlYXRpbmcgd2hlbiB3b3JraW5n
IG9uIHRoaXMgY29kZSBpczoKLy8gCi8vICJiYXNlIGZpbGVzIGFyZSBuZXcsIGRlcml2ZWQgZmls
ZXMgYXJlIG9sZCIKLy8KLy8gaXQgbWFrZXMgdGhlIGNvZGUgY29uZnVzaW5nLCBJIGtub3cuIHRo
aXMgaXMgcG9zc2libHkgdGhlIHdvcnN0IHBhcnQgb2YKLy8gdGhlIHByb2dyYW0uIEkgZG9uJ3Qg
a25vdyBpZiB0aGVyZSdzIGFueSB3YXkgdG8gbWFrZSBpdCBjbGVhcmVyLgoKY2xhc3MgdHJhbnNh
Y3Rpb25fZ3VhcmQ7CnN0cnVjdCBwb3N0aW5nOwpzdHJ1Y3QgYXBwX3N0YXRlOwoKY2xhc3MgZGF0
YWJhc2UKewogIGZzOjpwYXRoIGZpbGVuYW1lOwogIHN0ZDo6c3RyaW5nIGNvbnN0IHNjaGVtYTsK
ICB2b2lkIGNoZWNrX3NjaGVtYSgpOwoKICBzdHJ1Y3QgYXBwX3N0YXRlICogX19hcHA7CiAgc3Ry
dWN0IHNxbGl0ZTMgKiBfX3NxbDsKICBzdHJ1Y3Qgc3FsaXRlMyAqIHNxbChib29sIGluaXQgPSBm
YWxzZSk7CiAgaW50IHRyYW5zYWN0aW9uX2xldmVsOwoKICB2b2lkIGluc3RhbGxfZnVuY3Rpb25z
KGFwcF9zdGF0ZSAqIGFwcCk7CiAgdm9pZCBpbnN0YWxsX3ZpZXdzKCk7CgogIHR5cGVkZWYgc3Rk
Ojp2ZWN0b3I8IHN0ZDo6dmVjdG9yPHN0ZDo6c3RyaW5nPiA+IHJlc3VsdHM7CiAgdm9pZCBleGVj
dXRlKGNoYXIgY29uc3QgKiBxdWVyeSwgLi4uKTsKICB2b2lkIGZldGNoKHJlc3VsdHMgJiByZXMs
IAogICAgICAgICAgICAgaW50IGNvbnN0IHdhbnRfY29scywgCiAgICAgICAgICAgICBpbnQgY29u
c3Qgd2FudF9yb3dzLCAKICAgICAgICAgICAgIGNoYXIgY29uc3QgKiBxdWVyeSwgLi4uKTsKCiAg
Ym9vbCBleGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkZW50LCAKICAgICAgICAgICAgICBzdGQ6
OnN0cmluZyBjb25zdCAmIHRhYmxlKTsKICBib29sIGRlbHRhX2V4aXN0cyhoZXhlbmM8aWQ+IGNv
bnN0ICYgaWRlbnQsCiAgICAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJs
ZSk7CiAgYm9vbCBkZWx0YV9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkZW50LAogICAgICAg
ICAgICAgICAgICAgIGhleGVuYzxpZD4gY29uc3QgJiBiYXNlLAogICAgICAgICAgICAgICAgICAg
IHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOwoKICB1bnNpZ25lZCBsb25nIGNvdW50KHN0ZDo6
c3RyaW5nIGNvbnN0ICYgdGFibGUpOwoKICB2b2lkIGdldF9pZHMoc3RkOjpzdHJpbmcgY29uc3Qg
JiB0YWJsZSwgc3RkOjpzZXQ8IGhleGVuYzxpZD4gPiAmIGlkcyk7IAoKICB2b2lkIGdldChoZXhl
bmM8aWQ+IGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgIGJhc2U2NDwgZ3ppcDxkYXRhPiA+ICYg
ZGF0LAogICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOwogIHZvaWQgZ2V0X2Rl
bHRhKGhleGVuYzxpZD4gY29uc3QgJiBpZGVudCwKICAgICAgICAgICAgICAgICBoZXhlbmM8aWQ+
IGNvbnN0ICYgYmFzZSwKICAgICAgICAgICAgICAgICBiYXNlNjQ8IGd6aXA8ZGVsdGE+ID4gJiBk
ZWwsCiAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7CiAgdm9pZCBn
ZXRfdmVyc2lvbihoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgICBiYXNl
NjQ8IGd6aXA8ZGF0YT4gPiAmIGRhdCwKICAgICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNv
bnN0ICYgZGF0YV90YWJsZSwKICAgICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYg
ZGVsdGFfdGFibGUpOwogIAogIHZvaWQgcHV0KGhleGVuYzxpZD4gY29uc3QgJiBuZXdfaWQsCiAg
ICAgICAgICAgYmFzZTY0PCBnemlwPGRhdGE+ID4gY29uc3QgJiBkYXQsCiAgICAgICAgICAgc3Rk
OjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7CiAgdm9pZCBkcm9wKGhleGVuYzxpZD4gY29uc3QgJiBi
YXNlLAogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxlKTsKICB2b2lkIHB1dF9k
ZWx0YShoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgaGV4ZW5jPGlkPiBj
b25zdCAmIGJhc2UsCiAgICAgICAgICAgICAgICAgYmFzZTY0PCBnemlwPGRlbHRhPiA+IGNvbnN0
ICYgZGVsLAogICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOwogIHZv
aWQgcHV0X3ZlcnNpb24oaGV4ZW5jPGlkPiBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAg
ICAgIGhleGVuYzxpZD4gY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAgICAgICAgICBiYXNlNjQ8
IGd6aXA8ZGVsdGE+ID4gY29uc3QgJiBkZWwsCiAgICAgICAgICAgICAgICAgICBzdGQ6OnN0cmlu
ZyBjb25zdCAmIGRhdGFfdGFibGUsCiAgICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25z
dCAmIGRlbHRhX3RhYmxlKTsKICB2b2lkIHB1dF9yZXZlcnNlX3ZlcnNpb24oaGV4ZW5jPGlkPiBj
b25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV4ZW5jPGlkPiBjb25z
dCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTY0PCBnemlwPGRlbHRh
PiA+IGNvbnN0ICYgcmV2ZXJzZV9kZWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6
c3RyaW5nIGNvbnN0ICYgZGF0YV90YWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Rk
OjpzdHJpbmcgY29uc3QgJiBkZWx0YV90YWJsZSk7CgogIHZvaWQgZ2V0X2tleXMoc3RkOjpzdHJp
bmcgY29uc3QgJiB0YWJsZSwgc3RkOjp2ZWN0b3I8cnNhX2tleXBhaXJfaWQ+ICYga2V5cyk7Cgog
IGJvb2wgY2VydF9leGlzdHMoY2VydCBjb25zdCAmIHQsCiAgICAgICAgICAgICAgICAgIHN0ZDo6
c3RyaW5nIGNvbnN0ICYgdGFibGUpOwogIHZvaWQgcHV0X2NlcnQoY2VydCBjb25zdCAmIHQsIHN0
ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOyAgCiAgdm9pZCByZXN1bHRzX3RvX2NlcnRzKHJlc3Vs
dHMgY29uc3QgJiByZXMsCiAgICAgICAgICAgICAgICAgICAgICAgc3RkOjp2ZWN0b3I8Y2VydD4g
JiBjZXJ0cyk7CgogIHZvaWQgZ2V0X2NlcnRzKHN0ZDo6dmVjdG9yPCBjZXJ0ID4gJiBjZXJ0cywK
ICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAmIHRhYmxlKTsgIAoKICB2b2lkIGdl
dF9jZXJ0cyhoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICAgIHN0ZDo6dmVj
dG9yPCBjZXJ0ID4gJiBjZXJ0cywKICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZyBjb25zdCAm
IHRhYmxlKTsgIAoKICB2b2lkIGdldF9jZXJ0cyhjZXJ0X25hbWUgY29uc3QgJiBuYW1lLCAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgc3RkOjp2ZWN0b3I8IGNlcnQgPiAmIGNlcnRzLAog
ICAgICAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvbnN0ICYgdGFibGUpOwoKICB2b2lkIGdldF9j
ZXJ0cyhoZXhlbmM8aWQ+IGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgY2VydF9uYW1lIGNv
bnN0ICYgbmFtZSwKICAgICAgICAgICAgICAgICBzdGQ6OnZlY3RvcjwgY2VydCA+ICYgY2VydHMs
CiAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7ICAKCiAgdm9pZCBn
ZXRfY2VydHMoaGV4ZW5jPGlkPiBjb25zdCAmIGlkLAogICAgICAgICAgICAgICAgIGNlcnRfbmFt
ZSBjb25zdCAmIG5hbWUsCiAgICAgICAgICAgICAgICAgYmFzZTY0PGNlcnRfdmFsdWU+IGNvbnN0
ICYgdmFsLCAKICAgICAgICAgICAgICAgICBzdGQ6OnZlY3RvcjwgY2VydCA+ICYgY2VydHMsCiAg
ICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7ICAKCiAgdm9pZCBnZXRf
Y2VydHMoY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwKICAgICAgICAgICAgICAgICBiYXNlNjQ8Y2Vy
dF92YWx1ZT4gY29uc3QgJiB2YWwsIAogICAgICAgICAgICAgICAgIHN0ZDo6dmVjdG9yPGNlcnQ+
ICYgY2VydHMsCiAgICAgICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29uc3QgJiB0YWJsZSk7Cgog
IHZvaWQgYmVnaW5fdHJhbnNhY3Rpb24oKTsKICB2b2lkIGNvbW1pdF90cmFuc2FjdGlvbigpOwog
IHZvaWQgcm9sbGJhY2tfdHJhbnNhY3Rpb24oKTsKICBmcmllbmQgY2xhc3MgdHJhbnNhY3Rpb25f
Z3VhcmQ7CiAgZnJpZW5kIHZvaWQgcmNzX3B1dF9yYXdfZmlsZV9lZGdlKGhleGVuYzxpZD4gY29u
c3QgJiBvbGRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhleGVuYzxp
ZD4gY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJh
c2U2NDwgZ3ppcDxkZWx0YT4gPiBjb25zdCAmIGRlbCwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZGF0YWJhc2UgJiBkYik7CiAgZnJpZW5kIHZvaWQgcmNzX3B1dF9yYXdfbWFu
aWZlc3RfZWRnZShoZXhlbmM8aWQ+IGNvbnN0ICYgb2xkX2lkLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaGV4ZW5jPGlkPiBjb25zdCAmIG5ld19pZCwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U2NDwgZ3ppcDxkZWx0YT4gPiBjb25z
dCAmIGRlbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNl
ICYgZGIpOwoKcHVibGljOgoKICBkYXRhYmFzZShmczo6cGF0aCBjb25zdCAmIGZpbGUpOwoKICB2
b2lkIHNldF9maWxlbmFtZShmczo6cGF0aCBjb25zdCAmIGZpbGUpOwogIHZvaWQgaW5pdGlhbGl6
ZSgpOwogIHZvaWQgZGVidWcoc3RkOjpzdHJpbmcgY29uc3QgJiBzcWwsIHN0ZDo6b3N0cmVhbSAm
IG91dCk7CiAgdm9pZCBkdW1wKHN0ZDo6b3N0cmVhbSAmKTsKICB2b2lkIGxvYWQoc3RkOjppc3Ry
ZWFtICYpOwogIHZvaWQgaW5mbyhzdGQ6Om9zdHJlYW0gJik7CiAgdm9pZCB2ZXJzaW9uKHN0ZDo6
b3N0cmVhbSAmKTsKICB2b2lkIG1pZ3JhdGUoKTsKICB2b2lkIHJlaGFzaCgpOwogIHZvaWQgZW5z
dXJlX29wZW4oKTsKICAKICBib29sIGZpbGVfdmVyc2lvbl9leGlzdHMoZmlsZV9pZCBjb25zdCAm
IGlkKTsKICBib29sIG1hbmlmZXN0X3ZlcnNpb25fZXhpc3RzKG1hbmlmZXN0X2lkIGNvbnN0ICYg
aWQpOwogIGJvb2wgcmV2aXNpb25fZXhpc3RzKHJldmlzaW9uX2lkIGNvbnN0ICYgaWQpOwoKICB2
b2lkIGdldF9maWxlX2lkcyhzdGQ6OnNldDxmaWxlX2lkPiAmIGlkcyk7CiAgdm9pZCBnZXRfbWFu
aWZlc3RfaWRzKHN0ZDo6c2V0PG1hbmlmZXN0X2lkPiAmIGlkcyk7CiAgdm9pZCBnZXRfcmV2aXNp
b25faWRzKHN0ZDo6c2V0PHJldmlzaW9uX2lkPiAmIGlkcyk7CgogIHZvaWQgc2V0X2FwcChhcHBf
c3RhdGUgKiBhcHApOwogIAogIC8vIGdldCBwbGFpbiB2ZXJzaW9uIGlmIGl0IGV4aXN0cywgb3Ig
cmVjb25zdHJ1Y3QgdmVyc2lvbgogIC8vIGZyb20gZGVsdGFzIChpZiB0aGV5IGV4aXN0KQogIHZv
aWQgZ2V0X2ZpbGVfdmVyc2lvbihmaWxlX2lkIGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAg
ICAgICAgIGZpbGVfZGF0YSAmIGRhdCk7CgogIC8vIGdldCBmaWxlIGRlbHRhIGlmIGl0IGV4aXN0
cywgZWxzZSBjYWxjdWxhdGUgaXQuCiAgLy8gYm90aCBtYW5pZmVzdHMgbXVzdCBleGlzdC4KICB2
b2lkIGdldF9maWxlX2RlbHRhKGZpbGVfaWQgY29uc3QgJiBzcmMsCiAgICAgICAgICAgICAgICAg
ICAgICBmaWxlX2lkIGNvbnN0ICYgZHN0LAogICAgICAgICAgICAgICAgICAgICAgZmlsZV9kZWx0
YSAmIGRlbCk7CgogIC8vIHB1dCBmaWxlIHcvbyBwcmVkZWNlc3NvciBpbnRvIGRiCiAgdm9pZCBw
dXRfZmlsZShmaWxlX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgICAgICAgZmlsZV9kYXRh
IGNvbnN0ICYgZGF0KTsKCiAgLy8gc3RvcmUgbmV3IHZlcnNpb24gYW5kIHVwZGF0ZSBvbGQgdmVy
c2lvbiB0byBiZSBhIGRlbHRhCiAgdm9pZCBwdXRfZmlsZV92ZXJzaW9uKGZpbGVfaWQgY29uc3Qg
JiBvbGRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfaWQgY29uc3QgJiBuZXdfaWQs
CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfZGVsdGEgY29uc3QgJiBkZWwpOwoKICAvLyBs
b2FkIGluIGEgImRpcmVjdCIgbmV3IC0+IG9sZCByZXZlcnNlIGVkZ2UgKHVzZWQgZHVyaW5nCiAg
Ly8gbmV0c3luYyBhbmQgQ1ZTIGxvYWQtaW4pCiAgdm9pZCBwdXRfZmlsZV9yZXZlcnNlX3ZlcnNp
b24oZmlsZV9pZCBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBmaWxlX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGZpbGVfZGVsdGEgY29uc3QgJiBkZWwpOwoKICAvLyBnZXQgcGxhaW4gdmVyc2lvbiBpZiBpdCBl
eGlzdHMsIG9yIHJlY29uc3RydWN0IHZlcnNpb24KICAvLyBmcm9tIGRlbHRhcyAoaWYgdGhleSBl
eGlzdCkuIAogIHZvaWQgZ2V0X21hbmlmZXN0X3ZlcnNpb24obWFuaWZlc3RfaWQgY29uc3QgJiBp
ZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2RhdGEgJiBkYXQpOwoKICAv
LyBnZXQgYSBjb25zdHJ1Y3RlZCBtYW5pZmVzdAogIHZvaWQgZ2V0X21hbmlmZXN0KG1hbmlmZXN0
X2lkIGNvbnN0ICYgaWQsCiAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3RfbWFwICYgbW0pOwoK
ICAvLyBnZXQgbWFuaWZlc3QgZGVsdGEgaWYgaXQgZXhpc3RzLCBlbHNlIGNhbGN1bGF0ZSBpdC4K
ICAvLyBib3RoIG1hbmlmZXN0cyBtdXN0IGV4aXN0LgogIHZvaWQgZ2V0X21hbmlmZXN0X2RlbHRh
KG1hbmlmZXN0X2lkIGNvbnN0ICYgc3JjLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlm
ZXN0X2lkIGNvbnN0ICYgZHN0LAogICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0X2Rl
bHRhICYgZGVsKTsKCiAgLy8gcHV0IG1hbmlmZXN0IHcvbyBwcmVkZWNlc3NvciBpbnRvIGRiCiAg
dm9pZCBwdXRfbWFuaWZlc3QobWFuaWZlc3RfaWQgY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAg
ICAgICAgICAgbWFuaWZlc3RfZGF0YSBjb25zdCAmIGRhdCk7CgogIC8vIHN0b3JlIG5ldyB2ZXJz
aW9uIGFuZCB1cGRhdGUgb2xkIHZlcnNpb24gdG8gYmUgYSBkZWx0YQogIHZvaWQgcHV0X21hbmlm
ZXN0X3ZlcnNpb24obWFuaWZlc3RfaWQgY29uc3QgJiBvbGRfaWQsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBtYW5pZmVzdF9pZCBjb25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG1hbmlmZXN0X2RlbHRhIGNvbnN0ICYgZGVsKTsKCiAgLy8gbG9hZCBpbiBhICJk
aXJlY3QiIG5ldyAtPiBvbGQgcmV2ZXJzZSBlZGdlICh1c2VkIGR1cmluZwogIC8vIG5ldHN5bmMg
YW5kIENWUyBsb2FkLWluKQogIHZvaWQgcHV0X21hbmlmZXN0X3JldmVyc2VfdmVyc2lvbihtYW5p
ZmVzdF9pZCBjb25zdCAmIG9sZF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbWFuaWZlc3RfaWQgY29uc3QgJiBuZXdfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG1hbmlmZXN0X2RlbHRhIGNvbnN0ICYgZGVsKTsKCgogIHZvaWQgZ2V0X3Jldmlz
aW9uX2FuY2VzdHJ5KHN0ZDo6bXVsdGltYXA8cmV2aXNpb25faWQsIHJldmlzaW9uX2lkPiAmIGdy
YXBoKTsKCiAgdm9pZCBnZXRfcmV2aXNpb25fcGFyZW50cyhyZXZpc2lvbl9pZCBjb25zdCAmIGlk
LAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnNldDxyZXZpc2lvbl9pZD4gJiBwYXJl
bnRzKTsKCiAgdm9pZCBnZXRfcmV2aXNpb25fY2hpbGRyZW4ocmV2aXNpb25faWQgY29uc3QgJiBp
ZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OnNldDxyZXZpc2lvbl9pZD4gJiBj
aGlsZHJlbik7CgogIHZvaWQgZ2V0X3JldmlzaW9uX21hbmlmZXN0KHJldmlzaW9uX2lkIGNvbnN0
ICYgY2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3RfaWQgJiBtaWQpOwoK
ICB2b2lkIGdldF9yZXZpc2lvbihyZXZpc2lvbl9pZCBjb25zdCAmIGlkLAogICAgICAgICAgICAg
ICAgICAgcmV2aXNpb25fc2V0ICYgY3MpOwoKICB2b2lkIGdldF9yZXZpc2lvbihyZXZpc2lvbl9p
ZCBjb25zdCAmIGlkLAogICAgICAgICAgICAgICAgICAgcmV2aXNpb25fZGF0YSAmIGRhdCk7Cgog
IHZvaWQgcHV0X3JldmlzaW9uKHJldmlzaW9uX2lkIGNvbnN0ICYgbmV3X2lkLAogICAgICAgICAg
ICAgICAgICAgcmV2aXNpb25fc2V0IGNvbnN0ICYgY3MpOwoKICB2b2lkIHB1dF9yZXZpc2lvbihy
ZXZpc2lvbl9pZCBjb25zdCAmIG5ld19pZCwKICAgICAgICAgICAgICAgICAgICByZXZpc2lvbl9k
YXRhIGNvbnN0ICYgZGF0KTsKICAKICB2b2lkIGRlbGV0ZV9leGlzdGluZ19yZXZzX2FuZF9jZXJ0
cygpOwoKICAvLyBjcnlwdG8ga2V5IC8gY2VydCBvcGVyYXRpb25zCgogIHZvaWQgZ2V0X2tleV9p
ZHMoc3RkOjpzdHJpbmcgY29uc3QgJiBwYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgc3RkOjp2
ZWN0b3I8cnNhX2tleXBhaXJfaWQ+ICYgcHVia2V5cywKICAgICAgICAgICAgICAgICAgIHN0ZDo6
dmVjdG9yPHJzYV9rZXlwYWlyX2lkPiAmIHByaXZrZXlzKTsKCiAgdm9pZCBnZXRfcHJpdmF0ZV9r
ZXlzKHN0ZDo6dmVjdG9yPHJzYV9rZXlwYWlyX2lkPiAmIHByaXZrZXlzKTsKICB2b2lkIGdldF9w
dWJsaWNfa2V5cyhzdGQ6OnZlY3Rvcjxyc2Ffa2V5cGFpcl9pZD4gJiBwdWJrZXlzKTsKCiAgYm9v
bCBrZXlfZXhpc3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwoKICBib29sIHB1YmxpY19r
ZXlfZXhpc3RzKGhleGVuYzxpZD4gY29uc3QgJiBoYXNoKTsKICBib29sIHB1YmxpY19rZXlfZXhp
c3RzKHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwogIGJvb2wgcHJpdmF0ZV9rZXlfZXhpc3Rz
KHJzYV9rZXlwYWlyX2lkIGNvbnN0ICYgaWQpOwogIAogIHZvaWQgZ2V0X3B1YmtleShoZXhlbmM8
aWQ+IGNvbnN0ICYgaGFzaCwgCiAgICAgICAgICAgICAgICAgIHJzYV9rZXlwYWlyX2lkICYgaWQs
CiAgICAgICAgICAgICAgICAgIGJhc2U2NDxyc2FfcHViX2tleT4gJiBwdWJfZW5jb2RlZCk7Cgog
IHZvaWQgZ2V0X2tleShyc2Ffa2V5cGFpcl9pZCBjb25zdCAmIGlkLCAKICAgICAgICAgICAgICAg
YmFzZTY0PHJzYV9wdWJfa2V5PiAmIHB1Yl9lbmNvZGVkKTsKCiAgdm9pZCBnZXRfa2V5KHJzYV9r
ZXlwYWlyX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICBiYXNlNjQ8IGFyYzQ8cnNhX3By
aXZfa2V5PiA+ICYgcHJpdl9lbmNvZGVkKTsKCiAgdm9pZCBwdXRfa2V5KHJzYV9rZXlwYWlyX2lk
IGNvbnN0ICYgaWQsIAogICAgICAgICAgICAgICBiYXNlNjQ8cnNhX3B1Yl9rZXk+IGNvbnN0ICYg
cHViX2VuY29kZWQpOwogIAogIHZvaWQgcHV0X2tleShyc2Ffa2V5cGFpcl9pZCBjb25zdCAmIGlk
LCAKICAgICAgICAgICAgICAgYmFzZTY0PCBhcmM0PHJzYV9wcml2X2tleT4gPiBjb25zdCAmIHBy
aXZfZW5jb2RlZCk7CiAgCiAgdm9pZCBwdXRfa2V5X3BhaXIocnNhX2tleXBhaXJfaWQgY29uc3Qg
JiBwdWJfaWQsIAogICAgICAgICAgICAgICAgICAgIGJhc2U2NDxyc2FfcHViX2tleT4gY29uc3Qg
JiBwdWJfZW5jb2RlZCwKICAgICAgICAgICAgICAgICAgICBiYXNlNjQ8IGFyYzQ8cnNhX3ByaXZf
a2V5PiA+IGNvbnN0ICYgcHJpdl9lbmNvZGVkKTsKCiAgdm9pZCBkZWxldGVfcHJpdmF0ZV9rZXko
cnNhX2tleXBhaXJfaWQgY29uc3QgJiBwdWJfaWQpOwoKICAvLyBub3RlOiB0aGlzIHNlY3Rpb24g
aXMgcmlkaWN1bG91cy4gcGxlYXNlIGRvIHNvbWV0aGluZyBhYm91dCBpdC4KCiAgYm9vbCBtYW5p
ZmVzdF9jZXJ0X2V4aXN0cyhtYW5pZmVzdDxjZXJ0PiBjb25zdCAmIGNlcnQpOwogIGJvb2wgbWFu
aWZlc3RfY2VydF9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gpOwogIHZvaWQgcHV0X21h
bmlmZXN0X2NlcnQobWFuaWZlc3Q8Y2VydD4gY29uc3QgJiBjZXJ0KTsKCiAgYm9vbCByZXZpc2lv
bl9jZXJ0X2V4aXN0cyhyZXZpc2lvbjxjZXJ0PiBjb25zdCAmIGNlcnQpOwogIGJvb2wgcmV2aXNp
b25fY2VydF9leGlzdHMoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gpOwoKICB2b2lkIHB1dF9yZXZp
c2lvbl9jZXJ0KHJldmlzaW9uPGNlcnQ+IGNvbnN0ICYgY2VydCk7CgogIC8vIHRoaXMgdmFyaWFu
dCBoYXMgdG8gYmUgcmF0aGVyIGNvYXJzZSBhbmQgZmFzdCwgZm9yIG5ldHN5bmMncyB1c2UKICB2
b2lkIGdldF9yZXZpc2lvbl9jZXJ0X2luZGV4KHN0ZDo6dmVjdG9yPCBzdGQ6OnBhaXI8aGV4ZW5j
PGlkPiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6cGFpcjxyZXZpc2lvbl9p
ZCwgcnNhX2tleXBhaXJfaWQ+ID4gPiAmIGlkeCk7CgogIHZvaWQgZ2V0X3JldmlzaW9uX2NlcnRz
KHN0ZDo6dmVjdG9yPCByZXZpc2lvbjxjZXJ0PiA+ICYgY2VydHMpOwoKICB2b2lkIGdldF9yZXZp
c2lvbl9jZXJ0cyhjZXJ0X25hbWUgY29uc3QgJiBuYW1lLCAKICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdGQ6OnZlY3RvcjwgcmV2aXNpb248Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRf
cmV2aXNpb25fY2VydHMocmV2aXNpb25faWQgY29uc3QgJiBpZCwgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RkOjp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQgZ2V0X3Jl
dmlzaW9uX2NlcnRzKGNlcnRfbmFtZSBjb25zdCAmIG5hbWUsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgYmFzZTY0PGNlcnRfdmFsdWU+IGNvbnN0ICYgdmFsLCAKICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdGQ6OnZlY3RvcjwgcmV2aXNpb248Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBn
ZXRfcmV2aXNpb25fY2VydHMocmV2aXNpb25faWQgY29uc3QgJiBpZCwgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgYmFzZTY0PGNlcnRfdmFsdWU+IGNvbnN0ICYgdmFsdWUsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RkOjp2ZWN0b3I8IHJldmlzaW9uPGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQg
Z2V0X3JldmlzaW9uX2NlcnRzKHJldmlzaW9uX2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0ZDo6dmVjdG9yPCByZXZpc2lvbjxjZXJ0PiA+ICYgY2VydHMpOwoKICB2
b2lkIGdldF9yZXZpc2lvbl9jZXJ0KGhleGVuYzxpZD4gY29uc3QgJiBoYXNoLAogICAgICAgICAg
ICAgICAgICAgICAgICAgcmV2aXNpb248Y2VydD4gJiBjZXJ0KTsKICAKICB2b2lkIGdldF9tYW5p
ZmVzdF9jZXJ0cyhtYW5pZmVzdF9pZCBjb25zdCAmIGlkLCAKICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdGQ6OnZlY3RvcjwgbWFuaWZlc3Q8Y2VydD4gPiAmIGNlcnRzKTsKCiAgdm9pZCBnZXRf
bWFuaWZlc3RfY2VydHMoY2VydF9uYW1lIGNvbnN0ICYgbmFtZSwgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RkOjp2ZWN0b3I8IG1hbmlmZXN0PGNlcnQ+ID4gJiBjZXJ0cyk7CgogIHZvaWQg
Z2V0X21hbmlmZXN0X2NlcnRzKG1hbmlmZXN0X2lkIGNvbnN0ICYgaWQsIAogICAgICAgICAgICAg
ICAgICAgICAgICAgIGNlcnRfbmFtZSBjb25zdCAmIG5hbWUsIAogICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0ZDo6dmVjdG9yPCBtYW5pZmVzdDxjZXJ0PiA+ICYgY2VydHMpOwogIAogIHZvaWQg
Z2V0X21hbmlmZXN0X2NlcnQoaGV4ZW5jPGlkPiBjb25zdCAmIGhhc2gsCiAgICAgICAgICAgICAg
ICAgICAgICAgICBtYW5pZmVzdDxjZXJ0PiAmIGNlcnQpOwoKICAvLyBlcG9jaHMgCgogIHZvaWQg
Z2V0X2Vwb2NocyhzdGQ6Om1hcDxjZXJ0X3ZhbHVlLCBlcG9jaF9kYXRhPiAmIGVwb2Nocyk7Cgog
IHZvaWQgZ2V0X2Vwb2NoKGVwb2NoX2lkIGNvbnN0ICYgZWlkLCBjZXJ0X3ZhbHVlICYgYnJhbmNo
LCBlcG9jaF9kYXRhICYgZXBvKTsKICAKICBib29sIGVwb2NoX2V4aXN0cyhlcG9jaF9pZCBjb25z
dCAmIGVpZCk7CgogIHZvaWQgc2V0X2Vwb2NoKGNlcnRfdmFsdWUgY29uc3QgJiBicmFuY2gsIGVw
b2NoX2RhdGEgY29uc3QgJiBlcG8pOyAgCgogIHZvaWQgY2xlYXJfZXBvY2goY2VydF92YWx1ZSBj
b25zdCAmIGJyYW5jaCk7CiAKICAvLyBjb21wbGV0aW9uIHN0dWZmCgogIHZvaWQgY29tcGxldGUo
c3RkOjpzdHJpbmcgY29uc3QgJiBwYXJ0aWFsLAogICAgICAgICAgICAgICAgc3RkOjpzZXQ8cmV2
aXNpb25faWQ+ICYgY29tcGxldGlvbnMpOwoKICB2b2lkIGNvbXBsZXRlKHN0ZDo6c3RyaW5nIGNv
bnN0ICYgcGFydGlhbCwKICAgICAgICAgICAgICAgIHN0ZDo6c2V0PG1hbmlmZXN0X2lkPiAmIGNv
bXBsZXRpb25zKTsKICAKICB2b2lkIGNvbXBsZXRlKHN0ZDo6c3RyaW5nIGNvbnN0ICYgcGFydGlh
bCwKICAgICAgICAgICAgICAgIHN0ZDo6c2V0PGZpbGVfaWQ+ICYgY29tcGxldGlvbnMpOwoKICB2
b2lkIGNvbXBsZXRlKGNvbW1hbmRzOjpzZWxlY3Rvcl90eXBlIHR5LAogICAgICAgICAgICAgICAg
c3RkOjpzdHJpbmcgY29uc3QgJiBwYXJ0aWFsLAogICAgICAgICAgICAgICAgc3RkOjp2ZWN0b3I8
c3RkOjpwYWlyPGNvbW1hbmRzOjpzZWxlY3Rvcl90eXBlLCAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdGQ6OnN0cmluZz4gPiBjb25zdCAmIGxpbWl0LAogICAgICAgICAg
ICAgICAgc3RkOjpzZXQ8c3RkOjpzdHJpbmc+ICYgY29tcGxldGlvbnMpOwogIAogIH5kYXRhYmFz
ZSgpOwoKfTsKCi8vIHRyYW5zYWN0aW9uIGd1YXJkcyBuZXN0LiBhY3F1aXJlIG9uZSBpbiBhbnkg
c2NvcGUgeW91J2QgbGlrZQovLyB0cmFuc2FjdGlvbi1wcm90ZWN0ZWQsIGFuZCBpdCdsbCBtYWtl
IHN1cmUgdGhlIGRiIGFib3J0cyBhCi8vIHR4biBpZiB0aGVyZSdzIGFueSBleGNlcHRpb24gYmVm
b3JlIHlvdSBjYWxsIGNvbW1pdCgpCgpjbGFzcyB0cmFuc2FjdGlvbl9ndWFyZAp7CiAgYm9vbCBj
b21taXR0ZWQ7CiAgZGF0YWJhc2UgJiBkYjsKcHVibGljOgogIHRyYW5zYWN0aW9uX2d1YXJkKGRh
dGFiYXNlICYgZCk7CiAgfnRyYW5zYWN0aW9uX2d1YXJkKCk7CiAgdm9pZCBjb21taXQoKTsKfTsK
CgoKI2VuZGlmIC8vIF9fREFUQUJBU0VfSEhfXwo=
])

UNB64(parent.b64, parent)
UNB64(left.b64, left)
UNB64(right.b64, right)
UNB64(correct.b64, correct)

AT_CHECK(cp -f parent testfile)
AT_CHECK(MONOTONE add testfile, [], [ignore], [ignore])
COMMIT(testbranch)
PARENT_SHA=`BASE_REVISION`

AT_CHECK(cp -f left testfile)
COMMIT(testbranch)

REVERT_TO($PARENT_SHA)

AT_CHECK(cp -f right testfile)
COMMIT(testbranch)

AT_CHECK(MONOTONE --branch=testbranch merge, [], [ignore], [ignore])

AT_CHECK(MONOTONE update, [], [ignore], [ignore])
AT_CHECK(cmp testfile correct)

AT_CLEANUP
