AT_SETUP([log and selectors returning multiple rids])
MONOTONE_SETUP

# testcase for bug #15877

ADD_FILE(testfile, [blah blah
])
AT_CHECK(MONOTONE commit -b testbranch --date "2005-08-16T03:16:00" -m foo, [], [ignore], [ignore])
R0=`BASE_REVISION`

SET_FILE(testfile, [stuff stuff
])
AT_CHECK(MONOTONE commit -b testbranch --date "2005-08-16T03:16:00" -m foo, [], [ignore], [ignore])
R1=`BASE_REVISION`

SET_FILE(testfile, [other other
])
AT_CHECK(MONOTONE commit -b otherbranch --date "2005-08-16T03:16:05" -m foo, [], [ignore], [ignore])
R2=`BASE_REVISION`

AT_CHECK(RAW_MONOTONE --db=$_ROOT_DIR/test.db --root=$_ROOT_DIR log --brief --revision d:2005-08-16, [], [stdout], [ignore])
AT_CHECK(grep $R0 stdout, [0], [ignore])
AT_CHECK(grep $R1 stdout, [0], [ignore])
AT_CHECK(grep $R2 stdout, [0], [ignore])

AT_CLEANUP
